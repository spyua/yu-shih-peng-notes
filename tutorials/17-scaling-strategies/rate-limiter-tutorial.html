<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rate Limiter è¨­è¨ˆå®Œå…¨æŒ‡å— | ç³»çµ±è¨­è¨ˆæ•™å­¸</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #00d4ff;
            --secondary-color: #7c3aed;
            --accent-color: #f59e0b;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --border-color: #334155;
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1a1f3a 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Back Button */
        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            padding: 10px 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-family: inherit;
            border-radius: 8px;
        }

        .back-btn:hover {
            background: var(--primary-color);
            color: var(--bg-dark);
            border-color: var(--primary-color);
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--secondary-color) 0%, var(--primary-color) 100%);
            padding: 4rem 2rem;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .header h1 {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.25rem;
            opacity: 0.95;
            max-width: 800px;
            margin: 0 auto;
        }

        /* Navigation */
        .nav {
            background: var(--bg-card);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            border-bottom: 2px solid var(--border-color);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            gap: 2rem;
            overflow-x: auto;
            scrollbar-width: thin;
        }

        .nav-item {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            border: 2px solid transparent;
            font-weight: 500;
        }

        .nav-item:hover {
            background: var(--bg-hover);
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .nav-item.active {
            background: var(--primary-color);
            color: var(--bg-dark);
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Section */
        .section {
            margin: 4rem 0;
            scroll-margin-top: 80px;
        }

        .section-title {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .section-title::before {
            content: '';
            width: 6px;
            height: 2.5rem;
            background: linear-gradient(to bottom, var(--primary-color), var(--secondary-color));
            border-radius: 3px;
        }

        .section-subtitle {
            font-size: 1.25rem;
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 2rem;
            margin: 1.5rem 0;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: var(--primary-color);
            box-shadow: 0 8px 16px rgba(0, 212, 255, 0.1);
            transform: translateY(-4px);
        }

        /* Algorithm Cards */
        .algorithm-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .algorithm-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 2rem;
            border: 2px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .algorithm-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .algorithm-card:hover::before {
            transform: scaleX(1);
        }

        .algorithm-card:hover {
            border-color: var(--primary-color);
            box-shadow: 0 12px 24px rgba(0, 212, 255, 0.2);
            transform: translateY(-8px);
        }

        .algorithm-card.active {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, var(--bg-card) 0%, #1a2435 100%);
        }

        .algorithm-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .algorithm-description {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        .pros-cons {
            display: grid;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .pros, .cons {
            padding: 1rem;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.02);
        }

        .pros {
            border-left: 4px solid var(--success-color);
        }

        .cons {
            border-left: 4px solid var(--error-color);
        }

        .pros h4, .cons h4 {
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .pros ul, .cons ul {
            list-style: none;
            padding-left: 1.5rem;
        }

        .pros li::before {
            content: 'âœ“';
            color: var(--success-color);
            font-weight: bold;
            margin-right: 0.5rem;
        }

        .cons li::before {
            content: 'âœ—';
            color: var(--error-color);
            font-weight: bold;
            margin-right: 0.5rem;
        }

        /* Visual Demo */
        .visual-demo {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            border: 2px solid var(--border-color);
        }

        .bucket-container {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 2rem;
            margin: 2rem 0;
            padding: 2rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }

        .bucket {
            width: 120px;
            height: 200px;
            border: 3px solid var(--primary-color);
            border-radius: 8px;
            position: relative;
            background: linear-gradient(to bottom, transparent 0%, rgba(0, 212, 255, 0.1) 100%);
            overflow: hidden;
        }

        .bucket-fill {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: linear-gradient(to top, var(--primary-color), rgba(0, 212, 255, 0.5));
            transition: height 0.5s ease;
            border-radius: 0 0 6px 6px;
        }

        .token {
            width: 40px;
            height: 40px;
            background: radial-gradient(circle, var(--accent-color), #d97706);
            border-radius: 50%;
            position: absolute;
            animation: float 2s ease-in-out infinite;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .demo-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.75rem 2rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0, 212, 255, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: var(--bg-hover);
            border: 2px solid var(--border-color);
        }

        .btn-secondary:hover {
            border-color: var(--primary-color);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        /* Debug Section */
        .debug-item {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 2rem;
            margin: 1.5rem 0;
            border-left: 4px solid var(--warning-color);
            transition: all 0.3s ease;
        }

        .debug-item:hover {
            box-shadow: 0 8px 16px rgba(245, 158, 11, 0.2);
            transform: translateX(8px);
        }

        .debug-title {
            font-size: 1.5rem;
            color: var(--warning-color);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .debug-problem {
            background: rgba(239, 68, 68, 0.1);
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            border-left: 3px solid var(--error-color);
        }

        .debug-solution {
            background: rgba(16, 185, 129, 0.1);
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            border-left: 3px solid var(--success-color);
        }

        .code-block {
            background: #000;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            overflow-x: auto;
            border: 1px solid var(--border-color);
            position: relative;
        }

        .code-block code {
            font-family: 'Monaco', 'Courier New', monospace;
            color: #00ff88;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .copy-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.5rem 1rem;
            background: var(--bg-hover);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s ease;
        }

        .copy-btn:hover {
            background: var(--primary-color);
            color: var(--bg-dark);
            border-color: var(--primary-color);
        }

        /* Comparison Table */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            background: var(--bg-card);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }

        .comparison-table th {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            color: white;
            padding: 1.25rem;
            text-align: left;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .comparison-table td {
            padding: 1.25rem;
            border-bottom: 1px solid var(--border-color);
        }

        .comparison-table tr:hover {
            background: var(--bg-hover);
        }

        .comparison-table tr:last-child td {
            border-bottom: none;
        }

        /* Quiz Section */
        .quiz-container {
            margin: 2rem 0;
        }

        .quiz-question {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            border: 2px solid var(--border-color);
        }

        .question-text {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: var(--primary-color);
        }

        .quiz-options {
            display: grid;
            gap: 1rem;
        }

        .quiz-option {
            padding: 1.25rem;
            background: rgba(255, 255, 255, 0.02);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .quiz-option:hover {
            border-color: var(--primary-color);
            background: rgba(0, 212, 255, 0.05);
            transform: translateX(8px);
        }

        .quiz-option.correct {
            border-color: var(--success-color);
            background: rgba(16, 185, 129, 0.1);
        }

        .quiz-option.incorrect {
            border-color: var(--error-color);
            background: rgba(239, 68, 68, 0.1);
        }

        .option-letter {
            width: 40px;
            height: 40px;
            background: var(--bg-hover);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .quiz-feedback {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 8px;
            display: none;
        }

        .quiz-feedback.show {
            display: block;
        }

        .quiz-feedback.correct {
            background: rgba(16, 185, 129, 0.1);
            border-left: 4px solid var(--success-color);
        }

        .quiz-feedback.incorrect {
            background: rgba(239, 68, 68, 0.1);
            border-left: 4px solid var(--error-color);
        }

        .quiz-score {
            background: linear-gradient(135deg, var(--secondary-color), var(--primary-color));
            padding: 2rem;
            border-radius: 12px;
            text-align: center;
            margin: 2rem 0;
            font-size: 1.5rem;
            font-weight: 700;
        }

        /* Reference Cards */
        .reference-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .reference-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 2rem;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .reference-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0, 212, 255, 0.2);
        }

        .reference-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        /* Footer */
        .footer {
            background: var(--bg-card);
            padding: 3rem 2rem;
            margin-top: 4rem;
            border-top: 2px solid var(--border-color);
            text-align: center;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .footer-link {
            color: var(--primary-color);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .footer-link:hover {
            color: var(--accent-color);
            text-decoration: underline;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .header p {
                font-size: 1rem;
            }

            .section-title {
                font-size: 2rem;
            }

            .algorithm-grid,
            .reference-grid {
                grid-template-columns: 1fr;
            }

            .nav-container {
                gap: 1rem;
            }

            .nav-item {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
            }

            .comparison-table {
                font-size: 0.85rem;
            }

            .comparison-table th,
            .comparison-table td {
                padding: 0.75rem;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }

        /* Badge */
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin: 0.25rem;
        }

        .badge-pro {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success-color);
            border: 1px solid var(--success-color);
        }

        .badge-con {
            background: rgba(239, 68, 68, 0.2);
            color: var(--error-color);
            border: 1px solid var(--error-color);
        }

        .badge-use {
            background: rgba(0, 212, 255, 0.2);
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }
    </style>
</head>
<body>
    <a href="../../index.html" class="back-btn">â† è¿”å›é¦–é </a>
    <!-- Header -->
    <header class="header">
        <h1>ğŸš¦ Rate Limiter ç³»çµ±è¨­è¨ˆå®Œå…¨æŒ‡å—</h1>
        <p>æ·±å…¥ç†è§£æµé‡æ§åˆ¶æ¼”ç®—æ³•èˆ‡åˆ†æ•£å¼ç³»çµ±å¯¦è¸ | å¾åŸºç¤åˆ°é€²éšçš„å®Œæ•´æ•™å­¸</p>
    </header>

    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-container">
            <div class="nav-item active" onclick="scrollToSection('intro')">ğŸ“– ç°¡ä»‹</div>
            <div class="nav-item" onclick="scrollToSection('algorithms')">âš™ï¸ æ¼”ç®—æ³•</div>
            <div class="nav-item" onclick="scrollToSection('debug')">ğŸ”§ å¯¦æˆ° Debug</div>
            <div class="nav-item" onclick="scrollToSection('reference')">ğŸ“‹ å¿«é€Ÿåƒè€ƒ</div>
            <div class="nav-item" onclick="scrollToSection('quiz')">ğŸ¯ æ¸¬é©—</div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="container">
        <!-- Introduction Section -->
        <section id="intro" class="section fade-in">
            <h2 class="section-title">ä»€éº¼æ˜¯ Rate Limiterï¼Ÿ</h2>
            <p class="section-subtitle">åœ¨ç¶²è·¯ç³»çµ±ä¸­æ§åˆ¶æµé‡é€Ÿç‡çš„é—œéµå…ƒä»¶</p>

            <div class="card">
                <h3 style="color: var(--primary-color); margin-bottom: 1rem;">æ ¸å¿ƒåŠŸèƒ½</h3>
                <p style="font-size: 1.1rem; line-height: 1.8; color: var(--text-secondary);">
                    Rate Limiterï¼ˆæµé‡é™åˆ¶å™¨ï¼‰ç”¨æ–¼æ§åˆ¶å®¢æˆ¶ç«¯æˆ–æœå‹™åœ¨æŒ‡å®šæ™‚é–“å…§ç™¼é€çš„æµé‡é€Ÿç‡ã€‚
                    åœ¨ HTTP ä¸–ç•Œä¸­ï¼Œå®ƒé™åˆ¶å®¢æˆ¶ç«¯åœ¨ç‰¹å®šæ™‚é–“æ®µå…§å…è¨±ç™¼é€çš„è«‹æ±‚æ•¸é‡ã€‚
                    ç•¶ API è«‹æ±‚æ•¸è¶…éå®šç¾©çš„é–¾å€¼æ™‚ï¼Œæ‰€æœ‰å¤šé¤˜çš„è«‹æ±‚éƒ½æœƒè¢«é˜»æ“‹ã€‚
                </p>
            </div>

            <div class="reference-grid">
                <div class="reference-card">
                    <div class="reference-title">ğŸ›¡ï¸ é˜²æ­¢è³‡æºè€—ç›¡</div>
                    <p style="color: var(--text-secondary);">
                        é˜»æ“‹ DoS æ”»æ“Šï¼ˆç„¡è«–æ˜¯æƒ¡æ„æˆ–ç„¡æ„çš„ï¼‰ï¼Œé˜²æ­¢ç³»çµ±è³‡æºè¢«éåº¦æ¶ˆè€—ã€‚
                        å¤§å‹ç§‘æŠ€å…¬å¸å¹¾ä¹éƒ½æœƒåœ¨å…¶ API ä¸Šå¼·åˆ¶åŸ·è¡ŒæŸç¨®å½¢å¼çš„æµé‡é™åˆ¶ã€‚
                    </p>
                </div>

                <div class="reference-card">
                    <div class="reference-title">ğŸ’° é™ä½æˆæœ¬</div>
                    <p style="color: var(--text-secondary);">
                        é™åˆ¶å¤šé¤˜è«‹æ±‚æ„å‘³è‘—éœ€è¦æ›´å°‘çš„ä¼ºæœå™¨ï¼Œä¸¦å¯å°‡æ›´å¤šè³‡æºåˆ†é…çµ¦é«˜å„ªå…ˆç´š APIã€‚
                        å°æ–¼ä½¿ç”¨ä»˜è²»ç¬¬ä¸‰æ–¹ API çš„å…¬å¸å°¤å…¶é‡è¦ã€‚
                    </p>
                </div>

                <div class="reference-card">
                    <div class="reference-title">âš¡ é¿å…ä¼ºæœå™¨éè¼‰</div>
                    <p style="color: var(--text-secondary);">
                        éæ¿¾æ‰æ©Ÿå™¨äººæˆ–ä½¿ç”¨è€…èª¤æ“ä½œé€ æˆçš„éé‡è«‹æ±‚ï¼Œæ¸›å°‘ä¼ºæœå™¨è² è¼‰ï¼Œ
                        ç¢ºä¿ç³»çµ±ç©©å®šé‹è¡Œã€‚
                    </p>
                </div>
            </div>
        </section>

        <!-- Algorithms Section -->
        <section id="algorithms" class="section">
            <h2 class="section-title">äº”ç¨®æ ¸å¿ƒæ¼”ç®—æ³•</h2>
            <p class="section-subtitle">æ¯ç¨®æ¼”ç®—æ³•éƒ½æœ‰å…¶ç¨ç‰¹çš„å„ªç¼ºé»å’Œé©ç”¨å ´æ™¯</p>

            <div class="algorithm-grid">
                <!-- Token Bucket -->
                <div class="algorithm-card" onclick="toggleAlgorithm(this)">
                    <div class="algorithm-name">ğŸª£ Token Bucket</div>
                    <div class="algorithm-description">
                        ä»¤ç‰Œæ¡¶æ¼”ç®—æ³•æ˜¯æœ€å»£æ³›ä½¿ç”¨çš„æµé‡é™åˆ¶æ–¹æ³•ï¼ŒAmazon å’Œ Stripe éƒ½æ¡ç”¨æ­¤æ¼”ç®—æ³•ã€‚
                        ä»¤ç‰Œä»¥å›ºå®šé€Ÿç‡åŠ å…¥æ¡¶ä¸­ï¼Œæ¯å€‹è«‹æ±‚æ¶ˆè€—ä¸€å€‹ä»¤ç‰Œã€‚
                    </div>
                    <div class="pros-cons">
                        <div class="pros">
                            <h4>âœ… å„ªé»</h4>
                            <ul>
                                <li>å¯¦ä½œç°¡å–®</li>
                                <li>è¨˜æ†¶é«”æ•ˆç‡é«˜</li>
                                <li>å…è¨±çŸ­æœŸæµé‡çªç™¼</li>
                            </ul>
                        </div>
                        <div class="cons">
                            <h4>âŒ ç¼ºé»</h4>
                            <ul>
                                <li>éœ€è¦èª¿æ•´æ¡¶å¤§å°å’Œå¡«å……é€Ÿç‡å…©å€‹åƒæ•¸</li>
                                <li>åƒæ•¸èª¿å„ªå¯èƒ½å…·æœ‰æŒ‘æˆ°æ€§</li>
                            </ul>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="badge badge-use">Amazon</span>
                        <span class="badge badge-use">Stripe</span>
                        <span class="badge badge-pro">æ”¯æ´çªç™¼æµé‡</span>
                    </div>
                </div>

                <!-- Leaking Bucket -->
                <div class="algorithm-card" onclick="toggleAlgorithm(this)">
                    <div class="algorithm-name">ğŸ’§ Leaking Bucket</div>
                    <div class="algorithm-description">
                        æ¼æ¡¶æ¼”ç®—æ³•ä»¥å›ºå®šé€Ÿç‡è™•ç†è«‹æ±‚ï¼Œé€šå¸¸ä½¿ç”¨ FIFO ä½‡åˆ—å¯¦ä½œã€‚
                        è«‹æ±‚é€²å…¥ä½‡åˆ—ï¼Œç„¶å¾Œä»¥ç©©å®šçš„é€Ÿç‡è¢«è™•ç†ã€‚
                    </div>
                    <div class="pros-cons">
                        <div class="pros">
                            <h4>âœ… å„ªé»</h4>
                            <ul>
                                <li>è¨˜æ†¶é«”æ•ˆç‡é«˜ï¼ˆä½‡åˆ—å¤§å°æœ‰é™ï¼‰</li>
                                <li>å›ºå®šè™•ç†é€Ÿç‡ï¼Œé©åˆéœ€è¦ç©©å®šè¼¸å‡ºçš„å ´æ™¯</li>
                            </ul>
                        </div>
                        <div class="cons">
                            <h4>âŒ ç¼ºé»</h4>
                            <ul>
                                <li>æµé‡çªç™¼æœƒç”¨èˆŠè«‹æ±‚å¡«æ»¿ä½‡åˆ—</li>
                                <li>æœ€è¿‘çš„è«‹æ±‚å¯èƒ½è¢«é™æµ</li>
                                <li>å…©å€‹åƒæ•¸ä¸æ˜“èª¿å„ª</li>
                            </ul>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="badge badge-use">Shopify</span>
                        <span class="badge badge-pro">ç©©å®šè¼¸å‡º</span>
                    </div>
                </div>

                <!-- Fixed Window Counter -->
                <div class="algorithm-card" onclick="toggleAlgorithm(this)">
                    <div class="algorithm-name">ğŸ“Š Fixed Window Counter</div>
                    <div class="algorithm-description">
                        å›ºå®šè¦–çª—è¨ˆæ•¸å™¨å°‡æ™‚é–“è»¸åŠƒåˆ†ç‚ºå›ºå®šå¤§å°çš„æ™‚é–“è¦–çª—ï¼Œç‚ºæ¯å€‹è¦–çª—åˆ†é…è¨ˆæ•¸å™¨ã€‚
                        æ¯å€‹è«‹æ±‚ä½¿è¨ˆæ•¸å™¨åŠ ä¸€ï¼Œé”åˆ°é–¾å€¼å¾Œæ‹’çµ•æ–°è«‹æ±‚ã€‚
                    </div>
                    <div class="pros-cons">
                        <div class="pros">
                            <h4>âœ… å„ªé»</h4>
                            <ul>
                                <li>è¨˜æ†¶é«”æ•ˆç‡é«˜</li>
                                <li>å®¹æ˜“ç†è§£å’Œå¯¦ä½œ</li>
                                <li>åœ¨å–®ä½æ™‚é–“è¦–çª—çµæŸæ™‚é‡ç½®é…é¡ç¬¦åˆæŸäº›ä½¿ç”¨å ´æ™¯</li>
                            </ul>
                        </div>
                        <div class="cons">
                            <h4>âŒ ç¼ºé»</h4>
                            <ul>
                                <li>è¦–çª—é‚Šç•Œçš„æµé‡çªç™¼å¯èƒ½å°è‡´è¶…éé…é¡</li>
                                <li>ä¸å¤ ç²¾ç¢º</li>
                            </ul>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="badge badge-pro">ç°¡å–®æ˜“æ‡‚</span>
                        <span class="badge badge-con">é‚Šç•Œå•é¡Œ</span>
                    </div>
                </div>

                <!-- Sliding Window Log -->
                <div class="algorithm-card" onclick="toggleAlgorithm(this)">
                    <div class="algorithm-name">ğŸ“ Sliding Window Log</div>
                    <div class="algorithm-description">
                        æ»‘å‹•è¦–çª—æ—¥èªŒæ¼”ç®—æ³•è¿½è¹¤è«‹æ±‚æ™‚é–“æˆ³ï¼Œç§»é™¤éæœŸæ™‚é–“æˆ³ï¼Œ
                        ä¸¦æª¢æŸ¥æ—¥èªŒå¤§å°æ˜¯å¦åœ¨å…è¨±ç¯„åœå…§ã€‚é€šå¸¸ä½¿ç”¨ Redis çš„æœ‰åºé›†åˆå¯¦ä½œã€‚
                    </div>
                    <div class="pros-cons">
                        <div class="pros">
                            <h4>âœ… å„ªé»</h4>
                            <ul>
                                <li>éå¸¸ç²¾ç¢ºçš„æµé‡é™åˆ¶</li>
                                <li>åœ¨ä»»ä½•æ»¾å‹•è¦–çª—ä¸­ï¼Œè«‹æ±‚ä¸æœƒè¶…éé™åˆ¶</li>
                            </ul>
                        </div>
                        <div class="cons">
                            <h4>âŒ ç¼ºé»</h4>
                            <ul>
                                <li>è¨˜æ†¶é«”æ¶ˆè€—å¤§</li>
                                <li>å³ä½¿è«‹æ±‚è¢«æ‹’çµ•ï¼Œæ™‚é–“æˆ³å¯èƒ½ä»å­˜å„²åœ¨è¨˜æ†¶é«”ä¸­</li>
                            </ul>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="badge badge-pro">æœ€ç²¾ç¢º</span>
                        <span class="badge badge-con">é«˜è¨˜æ†¶é«”æ¶ˆè€—</span>
                    </div>
                </div>

                <!-- Sliding Window Counter -->
                <div class="algorithm-card" onclick="toggleAlgorithm(this)">
                    <div class="algorithm-name">ğŸ”„ Sliding Window Counter</div>
                    <div class="algorithm-description">
                        æ»‘å‹•è¦–çª—è¨ˆæ•¸å™¨æ˜¯å›ºå®šè¦–çª—è¨ˆæ•¸å™¨å’Œæ»‘å‹•è¦–çª—æ—¥èªŒçš„æ··åˆæ–¹æ³•ã€‚
                        å®ƒåŸºæ–¼å‰ä¸€è¦–çª—å’Œç•¶å‰è¦–çª—çš„å¹³å‡é€Ÿç‡é€²è¡Œè¨ˆç®—ã€‚
                    </div>
                    <div class="pros-cons">
                        <div class="pros">
                            <h4>âœ… å„ªé»</h4>
                            <ul>
                                <li>å¹³æ»‘æµé‡çªç™¼</li>
                                <li>è¨˜æ†¶é«”æ•ˆç‡é«˜</li>
                                <li>æ ¹æ“š Cloudflare å¯¦é©—ï¼Œåƒ… 0.003% çš„è«‹æ±‚è¢«éŒ¯èª¤å…è¨±æˆ–é™åˆ¶</li>
                            </ul>
                        </div>
                        <div class="cons">
                            <h4>âŒ ç¼ºé»</h4>
                            <ul>
                                <li>åƒ…é©ç”¨æ–¼ä¸å¤ªåš´æ ¼çš„å›æº¯è¦–çª—</li>
                                <li>å‡è¨­å‰ä¸€è¦–çª—çš„è«‹æ±‚å‡å‹»åˆ†ä½ˆï¼ˆè¿‘ä¼¼å€¼ï¼‰</li>
                            </ul>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <span class="badge badge-pro">å¹³è¡¡æ€§èƒ½</span>
                        <span class="badge badge-use">Cloudflare</span>
                    </div>
                </div>
            </div>

            <!-- Visual Demo -->
            <div class="visual-demo">
                <h3 style="color: var(--primary-color); margin-bottom: 1.5rem; text-align: center;">
                    ğŸ¬ Token Bucket äº’å‹•å¼æ¼”ç¤º
                </h3>
                <div class="bucket-container">
                    <div class="bucket" id="tokenBucket">
                        <div class="bucket-fill" id="bucketFill" style="height: 50%;"></div>
                        <div id="tokensDisplay" style="position: absolute; top: 10px; width: 100%; text-align: center; font-weight: bold;"></div>
                    </div>
                </div>
                <p style="text-align: center; color: var(--text-secondary); margin: 1rem 0;">
                    æ¡¶å®¹é‡: <strong id="bucketCapacity">4</strong> |
                    ç•¶å‰ä»¤ç‰Œæ•¸: <strong id="currentTokens">2</strong> |
                    å¡«å……é€Ÿç‡: <strong>1</strong> token/ç§’
                    <span id="autoRefillStatus" style="color: var(--success-color); margin-left: 0.5rem;">âš¡ è‡ªå‹•è£œå……ä¸­</span>
                </p>
                <div class="demo-controls">
                    <button class="btn" onclick="sendRequest()">ç™¼é€è«‹æ±‚</button>
                    <button class="btn btn-secondary" onclick="toggleAutoRefill()" id="toggleRefillBtn">æš«åœè£œå……</button>
                    <button class="btn btn-secondary" onclick="resetBucket()">é‡ç½®</button>
                </div>
                <div id="demoMessage" style="text-align: center; margin-top: 1rem; font-size: 1.1rem; font-weight: 600;"></div>

                <!-- API Sequence Flow -->
                <div class="sequence-flow" style="margin-top: 2rem; padding: 1.5rem; background: rgba(0,0,0,0.3); border-radius: 12px; border: 1px solid var(--border-color);">
                    <h4 style="color: var(--primary-color); text-align: center; margin-bottom: 1.5rem;">ğŸ“Š API Request Sequence Flow</h4>
                    <div class="flow-container" style="display: flex; align-items: center; justify-content: center; gap: 0.5rem; flex-wrap: wrap;">
                        <!-- Client -->
                        <div class="flow-node" style="background: var(--bg-card); border: 2px solid var(--primary-color); border-radius: 8px; padding: 0.75rem 1rem; text-align: center; min-width: 80px;">
                            <div style="font-size: 1.5rem;">ğŸ‘¤</div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">Client</div>
                        </div>

                        <!-- Arrow 1 -->
                        <div class="flow-arrow" style="color: var(--primary-color); font-size: 1.2rem;">â†’</div>

                        <!-- Rate Limiter -->
                        <div class="flow-node" id="flowRateLimiter" style="background: var(--bg-card); border: 2px solid var(--warning-color); border-radius: 8px; padding: 0.75rem 1rem; text-align: center; min-width: 100px; transition: all 0.3s;">
                            <div style="font-size: 1.5rem;">ğŸš¦</div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">Rate Limiter</div>
                        </div>

                        <!-- Arrow 2 -->
                        <div class="flow-arrow" style="color: var(--primary-color); font-size: 1.2rem;">â†’</div>

                        <!-- Token Check -->
                        <div class="flow-node" id="flowTokenCheck" style="background: var(--bg-card); border: 2px solid var(--secondary-color); border-radius: 8px; padding: 0.75rem 1rem; text-align: center; min-width: 100px; transition: all 0.3s;">
                            <div style="font-size: 1.5rem;">ğŸª£</div>
                            <div style="font-size: 0.85rem; color: var(--text-secondary);">Token Check</div>
                            <div id="flowTokenStatus" style="font-size: 0.75rem; margin-top: 0.25rem; color: var(--success-color);">tokens > 0?</div>
                        </div>

                        <!-- Branch -->
                        <div style="display: flex; flex-direction: column; gap: 0.5rem; margin-left: 0.5rem;">
                            <!-- Success Path -->
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <span style="color: var(--success-color); font-size: 0.9rem;">âœ“</span>
                                <div class="flow-node" id="flowSuccess" style="background: rgba(16, 185, 129, 0.1); border: 2px solid var(--success-color); border-radius: 8px; padding: 0.5rem 0.75rem; text-align: center; min-width: 90px; transition: all 0.3s;">
                                    <div style="font-size: 0.85rem; color: var(--success-color);">200 OK</div>
                                    <div style="font-size: 0.7rem; color: var(--text-muted);">token--</div>
                                </div>
                            </div>
                            <!-- Reject Path -->
                            <div style="display: flex; align-items: center; gap: 0.5rem;">
                                <span style="color: var(--error-color); font-size: 0.9rem;">âœ—</span>
                                <div class="flow-node" id="flowReject" style="background: rgba(239, 68, 68, 0.1); border: 2px solid var(--error-color); border-radius: 8px; padding: 0.5rem 0.75rem; text-align: center; min-width: 90px; transition: all 0.3s;">
                                    <div style="font-size: 0.85rem; color: var(--error-color);">429</div>
                                    <div style="font-size: 0.7rem; color: var(--text-muted);">Rejected</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Flow Legend -->
                    <div style="display: flex; justify-content: center; gap: 2rem; margin-top: 1rem; font-size: 0.8rem; color: var(--text-muted);">
                        <span>ğŸŸ¢ å…è¨±è«‹æ±‚æ™‚é«˜äº®ç¶ è‰²è·¯å¾‘</span>
                        <span>ğŸ”´ æ‹’çµ•è«‹æ±‚æ™‚é«˜äº®ç´…è‰²è·¯å¾‘</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Debug Section -->
        <section id="debug" class="section">
            <h2 class="section-title">å¯¦æˆ° Debug æŒ‡å—</h2>
            <p class="section-subtitle">å¸¸è¦‹å•é¡Œè¨ºæ–·èˆ‡è§£æ±ºæ–¹æ¡ˆ</p>

            <div class="debug-item">
                <div class="debug-title">âš ï¸ ç«¶çˆ­æ¢ä»¶ï¼ˆRace Conditionï¼‰</div>
                <div class="debug-problem">
                    <h4 style="color: var(--error-color); margin-bottom: 0.5rem;">âŒ å•é¡Œæè¿°</h4>
                    <p>åœ¨é«˜ä½µç™¼ç’°å¢ƒä¸­ï¼Œå¤šå€‹åŸ·è¡Œç·’åŒæ™‚è®€å–è¨ˆæ•¸å™¨å€¼ï¼Œå¯èƒ½å°è‡´è¨ˆæ•¸ä¸æº–ç¢ºã€‚</p>
                    <p style="margin-top: 0.5rem;"><strong>ç¯„ä¾‹ï¼š</strong>å…©å€‹è«‹æ±‚åŒæ™‚è®€å–è¨ˆæ•¸å™¨å€¼ç‚º 3ï¼Œéƒ½èªç‚ºå¯ä»¥é€šéï¼Œå°è‡´å¯¦éš›å…è¨±äº†è¶…éé™åˆ¶çš„è«‹æ±‚ã€‚</p>
                </div>
                <div class="debug-solution">
                    <h4 style="color: var(--success-color); margin-bottom: 0.5rem;">âœ… è§£æ±ºæ–¹æ¡ˆ</h4>
                    <p><strong>1. Lua Scriptï¼ˆæ¨è–¦ï¼‰</strong></p>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                        <code>-- Redis Lua Script ç¢ºä¿åŸå­æ€§æ“ä½œ
local key = KEYS[1]
local limit = tonumber(ARGV[1])
local current = tonumber(redis.call('get', key) or "0")

if current < limit then
    redis.call('incr', key)
    return 1
else
    return 0
end</code>
                    </div>
                    <p style="margin-top: 1rem;"><strong>2. Redis Sorted Sets</strong></p>
                    <p>ä½¿ç”¨ Redis çš„æœ‰åºé›†åˆä¾†è¿½è¹¤æ™‚é–“æˆ³ï¼Œé¿å…ç«¶çˆ­æ¢ä»¶ã€‚</p>
                </div>
            </div>

            <div class="debug-item">
                <div class="debug-title">âš ï¸ åˆ†æ•£å¼åŒæ­¥å•é¡Œ</div>
                <div class="debug-problem">
                    <h4 style="color: var(--error-color); margin-bottom: 0.5rem;">âŒ å•é¡Œæè¿°</h4>
                    <p>ä½¿ç”¨å¤šå€‹ Rate Limiter ä¼ºæœå™¨æ™‚ï¼Œå®¢æˆ¶ç«¯å¯èƒ½è¢«è·¯ç”±åˆ°ä¸åŒçš„ä¼ºæœå™¨ï¼Œå°è‡´æµé‡é™åˆ¶å¤±æ•ˆã€‚</p>
                </div>
                <div class="debug-solution">
                    <h4 style="color: var(--success-color); margin-bottom: 0.5rem;">âœ… è§£æ±ºæ–¹æ¡ˆ</h4>
                    <p><strong>ä½¿ç”¨é›†ä¸­å¼è³‡æ–™å­˜å„²ï¼ˆRedisï¼‰</strong></p>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                        <code># Redis è¨­å®šç¯„ä¾‹
# è¨­ç½®è¨ˆæ•¸å™¨ä¸¦è¨­å®šéæœŸæ™‚é–“
redis-cli SET rate_limit:user123 1 EX 60

# å¢åŠ è¨ˆæ•¸å™¨
redis-cli INCR rate_limit:user123

# æª¢æŸ¥ç•¶å‰å€¼
redis-cli GET rate_limit:user123</code>
                    </div>
                </div>
            </div>

            <div class="debug-item">
                <div class="debug-title">âš ï¸ HTTP Headers é™¤éŒ¯</div>
                <div class="debug-problem">
                    <h4 style="color: var(--error-color); margin-bottom: 0.5rem;">âŒ å•é¡Œæè¿°</h4>
                    <p>å®¢æˆ¶ç«¯ä¸çŸ¥é“ä½•æ™‚è¢«é™æµï¼Œä¹Ÿä¸çŸ¥é“é‚„å‰©å¤šå°‘è«‹æ±‚é…é¡ã€‚</p>
                </div>
                <div class="debug-solution">
                    <h4 style="color: var(--success-color); margin-bottom: 0.5rem;">âœ… è§£æ±ºæ–¹æ¡ˆ</h4>
                    <p><strong>è¿”å›æ¨™æº– Rate Limit Headers</strong></p>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                        <code># æª¢æŸ¥ Rate Limit Headers
curl -I https://api.example.com/endpoint

# å›æ‡‰ç¯„ä¾‹
HTTP/1.1 200 OK
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 75
X-RateLimit-Reset: 1640995200

# ç•¶è¶…éé™åˆ¶æ™‚
HTTP/1.1 429 Too Many Requests
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 0
X-RateLimit-Retry-After: 60
Retry-After: 60</code>
                    </div>
                </div>
            </div>

            <div class="debug-item">
                <div class="debug-title">âš ï¸ è¨˜æ†¶é«”éé«˜</div>
                <div class="debug-problem">
                    <h4 style="color: var(--error-color); margin-bottom: 0.5rem;">âŒ å•é¡Œæè¿°</h4>
                    <p>ä½¿ç”¨ Sliding Window Log æ™‚ï¼Œå„²å­˜å¤§é‡æ™‚é–“æˆ³å°è‡´è¨˜æ†¶é«”æ¶ˆè€—éé«˜ã€‚</p>
                </div>
                <div class="debug-solution">
                    <h4 style="color: var(--success-color); margin-bottom: 0.5rem;">âœ… è§£æ±ºæ–¹æ¡ˆ</h4>
                    <p><strong>1. ä½¿ç”¨ Sliding Window Counter æ›¿ä»£</strong></p>
                    <p>è¨˜æ†¶é«”æ•ˆç‡æ›´é«˜ï¼Œèª¤å·®åœ¨å¯æ¥å—ç¯„åœå…§ï¼ˆ0.003%ï¼‰ã€‚</p>
                    <p style="margin-top: 1rem;"><strong>2. å®šæœŸæ¸…ç†éæœŸè³‡æ–™</strong></p>
                    <div class="code-block">
                        <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                        <code># Redis è‡ªå‹•éæœŸè¨­å®š
redis-cli ZADD rate_limit:user123 1640995200 "request_id_1"
redis-cli EXPIRE rate_limit:user123 3600

# æ¸…ç†èˆŠæ™‚é–“æˆ³
redis-cli ZREMRANGEBYSCORE rate_limit:user123 0 1640991600</code>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3 style="color: var(--primary-color); margin-bottom: 1rem;">ğŸ› ï¸ è¨ºæ–·æŒ‡ä»¤é€ŸæŸ¥</h3>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode(this)">è¤‡è£½</button>
                    <code># ç›£æ§ Redis æ•ˆèƒ½
redis-cli INFO stats

# æŸ¥çœ‹è¨˜æ†¶é«”ä½¿ç”¨
redis-cli INFO memory

# æŸ¥çœ‹ç‰¹å®š key çš„ TTL
redis-cli TTL rate_limit:user123

# ç›£æ§å³æ™‚æŒ‡ä»¤
redis-cli MONITOR

# æŸ¥çœ‹æ…¢æŸ¥è©¢
redis-cli SLOWLOG GET 10

# æ¸¬è©¦ API Rate Limit
for i in {1..10}; do
  curl -w "\nStatus: %{http_code}\n" \
       -H "Authorization: Bearer TOKEN" \
       https://api.example.com/endpoint
done</code>
                </div>
            </div>
        </section>

        <!-- Reference Section -->
        <section id="reference" class="section">
            <h2 class="section-title">å¿«é€Ÿåƒè€ƒè¡¨</h2>
            <p class="section-subtitle">æ¼”ç®—æ³•æ¯”è¼ƒèˆ‡ç³»çµ±è¨­è¨ˆè¦é»</p>

            <h3 style="color: var(--primary-color); margin: 2rem 0 1rem;">æ¼”ç®—æ³•æ¯”è¼ƒ</h3>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>æ¼”ç®—æ³•</th>
                        <th>è¨˜æ†¶é«”æ•ˆç‡</th>
                        <th>ç²¾ç¢ºåº¦</th>
                        <th>æ”¯æ´çªç™¼æµé‡</th>
                        <th>é©ç”¨å ´æ™¯</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Token Bucket</strong></td>
                        <td>â­â­â­â­</td>
                        <td>â­â­â­</td>
                        <td>âœ… æ˜¯</td>
                        <td>é€šç”¨å ´æ™¯ï¼Œå…è¨±çŸ­æœŸçªç™¼</td>
                    </tr>
                    <tr>
                        <td><strong>Leaking Bucket</strong></td>
                        <td>â­â­â­â­</td>
                        <td>â­â­â­</td>
                        <td>âŒ å¦</td>
                        <td>éœ€è¦ç©©å®šè¼¸å‡ºé€Ÿç‡</td>
                    </tr>
                    <tr>
                        <td><strong>Fixed Window Counter</strong></td>
                        <td>â­â­â­â­â­</td>
                        <td>â­â­</td>
                        <td>âŒ å¦</td>
                        <td>ç°¡å–®å ´æ™¯ï¼Œå¯æ¥å—é‚Šç•Œèª¤å·®</td>
                    </tr>
                    <tr>
                        <td><strong>Sliding Window Log</strong></td>
                        <td>â­â­</td>
                        <td>â­â­â­â­â­</td>
                        <td>âŒ å¦</td>
                        <td>éœ€è¦é«˜ç²¾ç¢ºåº¦ï¼Œè¨˜æ†¶é«”å……è¶³</td>
                    </tr>
                    <tr>
                        <td><strong>Sliding Window Counter</strong></td>
                        <td>â­â­â­â­</td>
                        <td>â­â­â­â­</td>
                        <td>âœ… æ˜¯</td>
                        <td>å¹³è¡¡æ•ˆèƒ½èˆ‡ç²¾ç¢ºåº¦</td>
                    </tr>
                </tbody>
            </table>

            <h3 style="color: var(--primary-color); margin: 3rem 0 1rem;">ç³»çµ±è¨­è¨ˆè¦é»</h3>
            <div class="reference-grid">
                <div class="reference-card">
                    <div class="reference-title">ğŸ¯ Rate Limiter æ”¾ç½®ä½ç½®</div>
                    <ul style="color: var(--text-secondary); line-height: 1.8;">
                        <li>âœ… <strong>API Gateway</strong>ï¼šæœ€å¸¸è¦‹ï¼Œæ”¯æ´èªè­‰ã€SSLã€IP ç™½åå–®</li>
                        <li>âœ… <strong>Middleware</strong>ï¼šéˆæ´»æ§åˆ¶ï¼Œå¯è‡ªè¨‚æ¼”ç®—æ³•</li>
                        <li>âœ… <strong>Server-Side</strong>ï¼šå®Œå…¨æ§åˆ¶ï¼Œä½†éœ€è‡ªè¡Œå¯¦ä½œ</li>
                        <li>âŒ <strong>Client-Side</strong>ï¼šä¸å¯é ï¼Œå®¹æ˜“è¢«ç¹é</li>
                    </ul>
                </div>

                <div class="reference-card">
                    <div class="reference-title">âš™ï¸ æ ¸å¿ƒè¨­è¨ˆæ±ºç­–</div>
                    <ul style="color: var(--text-secondary); line-height: 1.8;">
                        <li>æ¼”ç®—æ³•é¸æ“‡ï¼šæ ¹æ“šæ¥­å‹™éœ€æ±‚å’Œæµé‡ç‰¹æ€§</li>
                        <li>é™æµç²’åº¦ï¼šIPã€User IDã€API Endpoint</li>
                        <li>è³‡æ–™å­˜å„²ï¼šRedisï¼ˆæ¨è–¦ï¼‰ã€Memcached</li>
                        <li>é™æµç­–ç•¥ï¼šHard Limit vs Soft Limit</li>
                    </ul>
                </div>

                <div class="reference-card">
                    <div class="reference-title">ğŸŒ åˆ†æ•£å¼è€ƒé‡</div>
                    <ul style="color: var(--text-secondary); line-height: 1.8;">
                        <li>ä½¿ç”¨é›†ä¸­å¼è³‡æ–™å­˜å„²ï¼ˆRedisï¼‰</li>
                        <li>å¤šè³‡æ–™ä¸­å¿ƒéƒ¨ç½²é™ä½å»¶é²</li>
                        <li>æœ€çµ‚ä¸€è‡´æ€§æ¨¡å‹</li>
                        <li>Edge Server è·¯ç”±</li>
                    </ul>
                </div>

                <div class="reference-card">
                    <div class="reference-title">ğŸ“Š ç›£æ§æŒ‡æ¨™</div>
                    <ul style="color: var(--text-secondary); line-height: 1.8;">
                        <li>è¢«é™æµçš„è«‹æ±‚æ•¸é‡å’Œæ¯”ä¾‹</li>
                        <li>429 éŒ¯èª¤ç‡è¶¨å‹¢</li>
                        <li>å„ API Endpoint çš„æµé‡åˆ†ä½ˆ</li>
                        <li>Redis æ•ˆèƒ½å’Œè¨˜æ†¶é«”ä½¿ç”¨</li>
                    </ul>
                </div>

                <div class="reference-card">
                    <div class="reference-title">ğŸ”’ å®‰å…¨æ€§è€ƒé‡</div>
                    <ul style="color: var(--text-secondary); line-height: 1.8;">
                        <li>é˜²æ­¢ DoS/DDoS æ”»æ“Š</li>
                        <li>IP ç™½åå–®/é»‘åå–®</li>
                        <li>å¤šå±¤æ¬¡é˜²è­·ï¼ˆL3/L7ï¼‰</li>
                        <li>è‡ªé©æ‡‰é™æµç­–ç•¥</li>
                    </ul>
                </div>

                <div class="reference-card">
                    <div class="reference-title">âš¡ æ•ˆèƒ½å„ªåŒ–</div>
                    <ul style="color: var(--text-secondary); line-height: 1.8;">
                        <li>ä½¿ç”¨æœ¬åœ°å¿«å–æ¸›å°‘ Redis è«‹æ±‚</li>
                        <li>æ‰¹æ¬¡è™•ç†æ¸›å°‘ç¶²è·¯å¾€è¿”</li>
                        <li>éåŒæ­¥è™•ç†è¢«é™æµçš„è«‹æ±‚</li>
                        <li>CDN å’Œ Edge Computing</li>
                    </ul>
                </div>
            </div>

            <h3 style="color: var(--primary-color); margin: 3rem 0 1rem;">ğŸ“ è¨˜æ†¶å£è¨£</h3>
            <div class="card">
                <h4 style="color: var(--accent-color); margin-bottom: 1rem;">é¸æ“‡æ¼”ç®—æ³•çš„æ±ºç­–æ¨¹</h4>
                <div style="background: rgba(0,0,0,0.3); padding: 1.5rem; border-radius: 8px; border-left: 4px solid var(--primary-color);">
                    <p style="font-size: 1.1rem; line-height: 2;">
                        <strong>1ï¸âƒ£ éœ€è¦æ”¯æ´çªç™¼æµé‡ï¼Ÿ</strong><br>
                        ã€€â””â”€ æ˜¯ â†’ Token Bucket / Sliding Window Counter<br>
                        ã€€â””â”€ å¦ â†’ ç¹¼çºŒ<br><br>
                        
                        <strong>2ï¸âƒ£ éœ€è¦æ¥µé«˜ç²¾ç¢ºåº¦ï¼Ÿ</strong><br>
                        ã€€â””â”€ æ˜¯ â†’ Sliding Window Log<br>
                        ã€€â””â”€ å¦ â†’ ç¹¼çºŒ<br><br>
                        
                        <strong>3ï¸âƒ£ éœ€è¦å›ºå®šè¼¸å‡ºé€Ÿç‡ï¼Ÿ</strong><br>
                        ã€€â””â”€ æ˜¯ â†’ Leaking Bucket<br>
                        ã€€â””â”€ å¦ â†’ Fixed Window Counterï¼ˆæœ€ç°¡å–®ï¼‰
                    </p>
                </div>
            </div>
        </section>

        <!-- Quiz Section -->
        <section id="quiz" class="section">
            <h2 class="section-title">çŸ¥è­˜æ¸¬é©—</h2>
            <p class="section-subtitle">æ¸¬è©¦ä½ å° Rate Limiter çš„ç†è§£ç¨‹åº¦</p>

            <div class="quiz-container">
                <!-- Question 1 -->
                <div class="quiz-question">
                    <div class="question-text">1. Amazon å’Œ Stripe ä½¿ç”¨å“ªç¨® Rate Limiting æ¼”ç®—æ³•ï¼Ÿ</div>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="checkAnswer(this, false, 0)">
                            <div class="option-letter">A</div>
                            <div>Leaking Bucket</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, true, 0)">
                            <div class="option-letter">B</div>
                            <div>Token Bucket</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, false, 0)">
                            <div class="option-letter">C</div>
                            <div>Fixed Window Counter</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, false, 0)">
                            <div class="option-letter">D</div>
                            <div>Sliding Window Log</div>
                        </div>
                    </div>
                    <div class="quiz-feedback">
                        <strong>èªªæ˜ï¼š</strong>Token Bucket æ¼”ç®—æ³•ç°¡å–®ã€é«˜æ•ˆä¸”æ”¯æ´çªç™¼æµé‡ï¼Œè¢« Amazon å’Œ Stripe å»£æ³›æ¡ç”¨ã€‚
                    </div>
                </div>

                <!-- Question 2 -->
                <div class="quiz-question">
                    <div class="question-text">2. å“ªç¨®æ¼”ç®—æ³•æœ€é©åˆéœ€è¦ã€Œç©©å®šè¼¸å‡ºé€Ÿç‡ã€çš„å ´æ™¯ï¼Ÿ</div>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="checkAnswer(this, false, 1)">
                            <div class="option-letter">A</div>
                            <div>Token Bucket</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, true, 1)">
                            <div class="option-letter">B</div>
                            <div>Leaking Bucket</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, false, 1)">
                            <div class="option-letter">C</div>
                            <div>Sliding Window Counter</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, false, 1)">
                            <div class="option-letter">D</div>
                            <div>Fixed Window Counter</div>
                        </div>
                    </div>
                    <div class="quiz-feedback">
                        <strong>èªªæ˜ï¼š</strong>Leaking Bucket ä»¥å›ºå®šé€Ÿç‡è™•ç†è«‹æ±‚ï¼Œç¢ºä¿è¼¸å‡ºé€Ÿç‡ç©©å®šï¼Œé©åˆéœ€è¦æ†å®šæµé‡çš„å ´æ™¯ã€‚
                    </div>
                </div>

                <!-- Question 3 -->
                <div class="quiz-question">
                    <div class="question-text">3. Fixed Window Counter çš„ä¸»è¦ç¼ºé»æ˜¯ä»€éº¼ï¼Ÿ</div>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="checkAnswer(this, false, 2)">
                            <div class="option-letter">A</div>
                            <div>è¨˜æ†¶é«”æ¶ˆè€—éé«˜</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, true, 2)">
                            <div class="option-letter">B</div>
                            <div>è¦–çª—é‚Šç•Œçš„æµé‡çªç™¼å¯èƒ½è¶…éé™åˆ¶</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, false, 2)">
                            <div class="option-letter">C</div>
                            <div>å¯¦ä½œè¤‡é›œ</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, false, 2)">
                            <div class="option-letter">D</div>
                            <div>ä¸æ”¯æ´çªç™¼æµé‡</div>
                        </div>
                    </div>
                    <div class="quiz-feedback">
                        <strong>èªªæ˜ï¼š</strong>åœ¨è¦–çª—é‚Šç•Œè™•ï¼Œå¯èƒ½æœ‰å…©å€æ–¼é™åˆ¶çš„è«‹æ±‚é€šéï¼Œä¾‹å¦‚ï¼šé™åˆ¶ 5 req/minï¼Œåœ¨ 2:00:30-2:01:30 ä¹‹é–“å¯èƒ½é€šé 10 å€‹è«‹æ±‚ã€‚
                    </div>
                </div>

                <!-- Question 4 -->
                <div class="quiz-question">
                    <div class="question-text">4. å“ªç¨®æ¼”ç®—æ³•çš„ç²¾ç¢ºåº¦æœ€é«˜ï¼Œä½†è¨˜æ†¶é«”æ¶ˆè€—ä¹Ÿæœ€å¤§ï¼Ÿ</div>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="checkAnswer(this, false, 3)">
                            <div class="option-letter">A</div>
                            <div>Token Bucket</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, false, 3)">
                            <div class="option-letter">B</div>
                            <div>Sliding Window Counter</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, true, 3)">
                            <div class="option-letter">C</div>
                            <div>Sliding Window Log</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, false, 3)">
                            <div class="option-letter">D</div>
                            <div>Fixed Window Counter</div>
                        </div>
                    </div>
                    <div class="quiz-feedback">
                        <strong>èªªæ˜ï¼š</strong>Sliding Window Log è¿½è¹¤æ¯å€‹è«‹æ±‚çš„æ™‚é–“æˆ³ï¼Œæä¾›æœ€ç²¾ç¢ºçš„é™æµï¼Œä½†éœ€è¦å„²å­˜å¤§é‡æ™‚é–“æˆ³è³‡æ–™ã€‚
                    </div>
                </div>

                <!-- Question 5 -->
                <div class="quiz-question">
                    <div class="question-text">5. ç•¶ API è«‹æ±‚è¢«é™æµæ™‚ï¼Œæ‡‰è©²è¿”å›å“ªå€‹ HTTP ç‹€æ…‹ç¢¼ï¼Ÿ</div>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="checkAnswer(this, false, 4)">
                            <div class="option-letter">A</div>
                            <div>403 Forbidden</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, true, 4)">
                            <div class="option-letter">B</div>
                            <div>429 Too Many Requests</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, false, 4)">
                            <div class="option-letter">C</div>
                            <div>503 Service Unavailable</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, false, 4)">
                            <div class="option-letter">D</div>
                            <div>500 Internal Server Error</div>
                        </div>
                    </div>
                    <div class="quiz-feedback">
                        <strong>èªªæ˜ï¼š</strong>429 Too Many Requests æ˜¯å°ˆé–€ç”¨æ–¼è¡¨ç¤ºè«‹æ±‚è¶…éé™åˆ¶çš„æ¨™æº– HTTP ç‹€æ…‹ç¢¼ã€‚
                    </div>
                </div>

                <!-- Question 6 -->
                <div class="quiz-question">
                    <div class="question-text">6. åœ¨åˆ†æ•£å¼ç’°å¢ƒä¸­ï¼Œç‚ºé¿å…ç«¶çˆ­æ¢ä»¶ï¼Œæ¨è–¦ä½¿ç”¨ä»€éº¼æŠ€è¡“ï¼Ÿ</div>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="checkAnswer(this, false, 5)">
                            <div class="option-letter">A</div>
                            <div>Sticky Sessions</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, true, 5)">
                            <div class="option-letter">B</div>
                            <div>Redis + Lua Script</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, false, 5)">
                            <div class="option-letter">C</div>
                            <div>æœ¬åœ°è¨˜æ†¶é«”å¿«å–</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, false, 5)">
                            <div class="option-letter">D</div>
                            <div>è³‡æ–™åº«é–</div>
                        </div>
                    </div>
                    <div class="quiz-feedback">
                        <strong>èªªæ˜ï¼š</strong>ä½¿ç”¨ Redis ä½œç‚ºé›†ä¸­å¼å­˜å„²ï¼Œé…åˆ Lua Script ç¢ºä¿åŸå­æ€§æ“ä½œï¼Œæ˜¯è§£æ±ºç«¶çˆ­æ¢ä»¶çš„æœ€ä½³å¯¦è¸ã€‚
                    </div>
                </div>

                <!-- Question 7 -->
                <div class="quiz-question">
                    <div class="question-text">7. Sliding Window Counter æ¼”ç®—æ³•çš„èª¤å·®ç‡ç´„ç‚ºå¤šå°‘ï¼Ÿï¼ˆæ ¹æ“š Cloudflare å¯¦é©—ï¼‰</div>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="checkAnswer(this, false, 6)">
                            <div class="option-letter">A</div>
                            <div>0.03%</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, false, 6)">
                            <div class="option-letter">B</div>
                            <div>0.3%</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, true, 6)">
                            <div class="option-letter">C</div>
                            <div>0.003%</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, false, 6)">
                            <div class="option-letter">D</div>
                            <div>0.0003%</div>
                        </div>
                    </div>
                    <div class="quiz-feedback">
                        <strong>èªªæ˜ï¼š</strong>Cloudflare å° 4 å„„å€‹è«‹æ±‚çš„æ¸¬è©¦é¡¯ç¤ºï¼ŒSliding Window Counter åƒ…æœ‰ 0.003% çš„è«‹æ±‚è¢«éŒ¯èª¤å…è¨±æˆ–é™åˆ¶ã€‚
                    </div>
                </div>

                <!-- Question 8 -->
                <div class="quiz-question">
                    <div class="question-text">8. Rate Limiter æ‡‰è©²è¿”å›å“ªäº› HTTP Headers çµ¦å®¢æˆ¶ç«¯ï¼Ÿ</div>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="checkAnswer(this, false, 7)">
                            <div class="option-letter">A</div>
                            <div>åªéœ€è¦ X-RateLimit-Limit</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, false, 7)">
                            <div class="option-letter">B</div>
                            <div>X-RateLimit-Limit å’Œ X-RateLimit-Remaining</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, true, 7)">
                            <div class="option-letter">C</div>
                            <div>X-RateLimit-Limitã€X-RateLimit-Remainingã€X-RateLimit-Retry-After</div>
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, false, 7)">
                            <div class="option-letter">D</div>
                            <div>ä¸éœ€è¦è¿”å›ä»»ä½•ç‰¹æ®Š Headers</div>
                        </div>
                    </div>
                    <div class="quiz-feedback">
                        <strong>èªªæ˜ï¼š</strong>æ‡‰è©²è¿”å›ä¸‰å€‹æ¨™æº– Headersï¼šLimitï¼ˆé™åˆ¶æ•¸ï¼‰ã€Remainingï¼ˆå‰©é¤˜æ•¸ï¼‰ã€Retry-Afterï¼ˆé‡è©¦æ™‚é–“ï¼‰ã€‚
                    </div>
                </div>
            </div>

            <div class="quiz-score" id="quizScore" style="display: none;">
                <div>ğŸ‰ æ¸¬é©—å®Œæˆï¼</div>
                <div style="margin-top: 1rem;">ä½ çš„åˆ†æ•¸ï¼š<span id="scoreDisplay"></span></div>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <h3 style="color: var(--primary-color); margin-bottom: 1rem;">ğŸ“š å»¶ä¼¸è³‡æº</h3>
        <div class="footer-links">
            <a href="https://redis.io/" class="footer-link" target="_blank">Redis å®˜æ–¹æ–‡ä»¶</a>
            <a href="https://cloud.google.com/solutions/rate-limiting-strategies-techniques" class="footer-link" target="_blank">Google Cloud: Rate Limiting Strategies</a>
            <a href="https://stripe.com/blog/rate-limiters" class="footer-link" target="_blank">Stripe: Rate Limiters</a>
            <a href="https://github.com/lyft/ratelimit" class="footer-link" target="_blank">Lyft: Open Source Rate Limiter</a>
        </div>
        <p style="margin-top: 2rem; color: var(--text-muted);">
            Â© 2025 Rate Limiter ç³»çµ±è¨­è¨ˆæ•™å­¸ | åŸºæ–¼ System Design Interview å…§å®¹è£½ä½œ
        </p>
    </footer>

    <script>
        // Smooth scroll to section
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            const navItems = document.querySelectorAll('.nav-item');
            
            navItems.forEach(item => item.classList.remove('active'));
            event.target.classList.add('active');
            
            section.scrollIntoView({ behavior: 'smooth' });
        }

        // Toggle algorithm card
        function toggleAlgorithm(card) {
            const cards = document.querySelectorAll('.algorithm-card');
            cards.forEach(c => {
                if (c !== card) {
                    c.classList.remove('active');
                }
            });
            card.classList.toggle('active');
        }

        // Token Bucket Demo
        let tokens = 2;
        const maxTokens = 4;
        let autoRefillEnabled = true;
        let refillIntervalId = null;

        function updateBucketDisplay() {
            const fillHeight = (tokens / maxTokens) * 100;
            document.getElementById('bucketFill').style.height = fillHeight + '%';
            document.getElementById('currentTokens').textContent = tokens;
            document.getElementById('bucketCapacity').textContent = maxTokens;
        }

        function sendRequest() {
            const message = document.getElementById('demoMessage');
            const flowRateLimiter = document.getElementById('flowRateLimiter');
            const flowTokenCheck = document.getElementById('flowTokenCheck');
            const flowSuccess = document.getElementById('flowSuccess');
            const flowReject = document.getElementById('flowReject');

            // Reset flow highlights
            resetFlowHighlights();

            // Animate flow: Rate Limiter
            flowRateLimiter.style.boxShadow = '0 0 15px var(--warning-color)';
            flowRateLimiter.style.transform = 'scale(1.05)';

            setTimeout(() => {
                // Animate flow: Token Check
                flowTokenCheck.style.boxShadow = '0 0 15px var(--secondary-color)';
                flowTokenCheck.style.transform = 'scale(1.05)';

                setTimeout(() => {
                    if (tokens > 0) {
                        tokens--;
                        message.textContent = 'âœ… è«‹æ±‚æˆåŠŸï¼ä»¤ç‰Œæ•¸: ' + tokens;
                        message.style.color = 'var(--success-color)';

                        // Highlight success path
                        flowSuccess.style.boxShadow = '0 0 20px var(--success-color)';
                        flowSuccess.style.transform = 'scale(1.1)';
                        flowSuccess.style.background = 'rgba(16, 185, 129, 0.3)';
                    } else {
                        message.textContent = 'âŒ è«‹æ±‚è¢«æ‹’çµ•ï¼ä»¤ç‰Œä¸è¶³ï¼ˆç­‰å¾…è‡ªå‹•è£œå……æˆ–ç¨å¾Œé‡è©¦ï¼‰';
                        message.style.color = 'var(--error-color)';

                        // Highlight reject path
                        flowReject.style.boxShadow = '0 0 20px var(--error-color)';
                        flowReject.style.transform = 'scale(1.1)';
                        flowReject.style.background = 'rgba(239, 68, 68, 0.3)';
                    }
                    updateBucketDisplay();

                    // Reset after animation
                    setTimeout(resetFlowHighlights, 800);
                }, 150);
            }, 150);
        }

        function resetFlowHighlights() {
            const nodes = ['flowRateLimiter', 'flowTokenCheck', 'flowSuccess', 'flowReject'];
            nodes.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.style.boxShadow = 'none';
                    el.style.transform = 'scale(1)';
                }
            });
            const flowSuccess = document.getElementById('flowSuccess');
            const flowReject = document.getElementById('flowReject');
            if (flowSuccess) flowSuccess.style.background = 'rgba(16, 185, 129, 0.1)';
            if (flowReject) flowReject.style.background = 'rgba(239, 68, 68, 0.1)';
        }

        function toggleAutoRefill() {
            const btn = document.getElementById('toggleRefillBtn');
            const status = document.getElementById('autoRefillStatus');
            const message = document.getElementById('demoMessage');

            if (autoRefillEnabled) {
                // æš«åœè‡ªå‹•è£œå……
                autoRefillEnabled = false;
                clearInterval(refillIntervalId);
                refillIntervalId = null;
                btn.textContent = 'ç¹¼çºŒè£œå……';
                status.textContent = 'â¸ï¸ å·²æš«åœ';
                status.style.color = 'var(--warning-color)';
                message.textContent = 'â¸ï¸ è‡ªå‹•è£œå……å·²æš«åœ';
                message.style.color = 'var(--warning-color)';
            } else {
                // ç¹¼çºŒè‡ªå‹•è£œå……
                autoRefillEnabled = true;
                startAutoRefill();
                btn.textContent = 'æš«åœè£œå……';
                status.textContent = 'âš¡ è‡ªå‹•è£œå……ä¸­';
                status.style.color = 'var(--success-color)';
                message.textContent = 'âš¡ è‡ªå‹•è£œå……å·²æ¢å¾©';
                message.style.color = 'var(--success-color)';
            }
        }

        function startAutoRefill() {
            // æ¯ç§’è£œå…… 1 å€‹ token
            refillIntervalId = setInterval(() => {
                if (tokens < maxTokens) {
                    tokens = Math.min(tokens + 1, maxTokens);
                    updateBucketDisplay();
                    // è£œå……æ™‚é–ƒçˆæ•ˆæœ
                    const bucket = document.getElementById('bucketFill');
                    bucket.style.boxShadow = '0 0 20px var(--primary-color)';
                    setTimeout(() => {
                        bucket.style.boxShadow = 'none';
                    }, 200);
                }
            }, 1000);
        }

        function resetBucket() {
            tokens = 2;
            autoRefillEnabled = true;

            // é‡ç½®è‡ªå‹•è£œå……
            if (refillIntervalId) {
                clearInterval(refillIntervalId);
            }
            startAutoRefill();

            // æ›´æ–° UI
            document.getElementById('toggleRefillBtn').textContent = 'æš«åœè£œå……';
            document.getElementById('autoRefillStatus').textContent = 'âš¡ è‡ªå‹•è£œå……ä¸­';
            document.getElementById('autoRefillStatus').style.color = 'var(--success-color)';
            document.getElementById('demoMessage').textContent = 'ğŸ”„ å·²é‡ç½®åˆ°åˆå§‹ç‹€æ…‹';
            document.getElementById('demoMessage').style.color = 'var(--text-secondary)';
            updateBucketDisplay();
        }

        // å•Ÿå‹•è‡ªå‹•è£œå……ï¼ˆ1 token/ç§’ï¼‰
        startAutoRefill();

        // Copy code function
        function copyCode(button) {
            const codeBlock = button.parentElement;
            const code = codeBlock.querySelector('code').textContent;
            
            navigator.clipboard.writeText(code).then(() => {
                const originalText = button.textContent;
                button.textContent = 'âœ“ å·²è¤‡è£½';
                button.style.background = 'var(--success-color)';
                button.style.color = 'white';
                
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = '';
                    button.style.color = '';
                }, 2000);
            });
        }

        // Quiz functionality
        let score = 0;
        let totalQuestions = 8;
        let answeredQuestions = new Set();

        function checkAnswer(option, isCorrect, questionIndex) {
            const question = option.closest('.quiz-question');
            const options = question.querySelectorAll('.quiz-option');
            const feedback = question.querySelector('.quiz-feedback');
            
            // Prevent multiple answers for same question
            if (answeredQuestions.has(questionIndex)) {
                return;
            }
            
            // Disable all options
            options.forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            // Mark answer
            if (isCorrect) {
                option.classList.add('correct');
                score++;
                feedback.classList.add('correct');
            } else {
                option.classList.add('incorrect');
                // Highlight correct answer
                options.forEach(opt => {
                    if (opt.onclick.toString().includes('true')) {
                        opt.classList.add('correct');
                    }
                });
                feedback.classList.add('incorrect');
            }
            
            feedback.classList.add('show');
            answeredQuestions.add(questionIndex);
            
            // Show final score
            if (answeredQuestions.size === totalQuestions) {
                setTimeout(() => {
                    showFinalScore();
                }, 1000);
            }
        }

        function showFinalScore() {
            const scoreElement = document.getElementById('quizScore');
            const scoreDisplay = document.getElementById('scoreDisplay');
            const percentage = (score / totalQuestions * 100).toFixed(0);
            
            scoreDisplay.textContent = score + ' / ' + totalQuestions + ' (' + percentage + '%)';
            scoreElement.style.display = 'block';
            scoreElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
            
            // Add emoji based on score
            if (percentage >= 90) {
                scoreDisplay.innerHTML += ' ğŸ† å„ªç§€ï¼';
            } else if (percentage >= 70) {
                scoreDisplay.innerHTML += ' ğŸ‘ ä¸éŒ¯ï¼';
            } else if (percentage >= 50) {
                scoreDisplay.innerHTML += ' ğŸ’ª ç¹¼çºŒåŠªåŠ›ï¼';
            } else {
                scoreDisplay.innerHTML += ' ğŸ“š å»ºè­°è¤‡ç¿’ï¼';
            }
        }

        // Initialize
        updateBucketDisplay();

        // Active nav on scroll
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('.section');
            const navItems = document.querySelectorAll('.nav-item');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (pageYOffset >= sectionTop - 100) {
                    current = section.getAttribute('id');
                }
            });
            
            navItems.forEach((item, index) => {
                item.classList.remove('active');
                if (item.textContent.includes(current)) {
                    item.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>