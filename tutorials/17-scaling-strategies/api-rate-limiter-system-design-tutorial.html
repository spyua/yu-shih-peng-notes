<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API é™æµå™¨ - å®Œæ•´ç³»çµ±è¨­è¨ˆæŒ‡å—</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Noto+Sans+TC:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #e2e8f0;
            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-muted: #94a3b8;

            --accent: #f59e0b;
            --accent-light: #fef3c7;
            --client: #3b82f6;
            --load-balancer: #8b5cf6;
            --rate-limiter: #f59e0b;
            --api-server: #10b981;
            --cache: #ef4444;
            --rules: #06b6d4;
            --logging: #ec4899;
            --storage: #6366f1;
            --success: #22c55e;
            --failure: #ef4444;
            --sync: #64748b;
            --async: #a855f7;

            --border-radius: 12px;
            --shadow: 0 1px 3px rgba(0,0,0,.1), 0 1px 2px rgba(0,0,0,.06);
            --shadow-lg: 0 4px 6px -1px rgba(0,0,0,.1), 0 2px 4px -2px rgba(0,0,0,.1);
        }
        *{margin:0;padding:0;box-sizing:border-box;}
        body{font-family:'Noto Sans TC',sans-serif;background:var(--bg-primary);color:var(--text-primary);line-height:1.8;overflow-x:hidden;}
        .container{max-width:1200px;margin:0 auto;padding:0 24px;}
        .container-narrow{max-width:900px;margin:0 auto;padding:0 24px;}

        /* ===== STICKY NAV ===== */
        .nav{position:sticky;top:0;background:rgba(255,255,255,.97);backdrop-filter:blur(12px);border-bottom:1px solid var(--bg-tertiary);z-index:200;padding:0;}
        .nav-inner{display:flex;align-items:center;justify-content:space-between;height:56px;}
        .nav-brand{font-weight:700;font-size:1.05rem;color:var(--text-primary);display:flex;align-items:center;gap:8px;text-decoration:none;}
        .nav-brand span{color:var(--accent);}

        /* Page-level tabs */
        .page-tabs{display:flex;gap:4px;height:100%;}
        .page-tab{
            padding:0 28px;display:flex;align-items:center;
            font-weight:500;font-size:14px;color:var(--text-muted);
            cursor:pointer;border-bottom:3px solid transparent;
            transition:all .2s;background:none;border-top:none;border-left:none;border-right:none;
        }
        .page-tab:hover{color:var(--text-secondary);}
        .page-tab.active{color:var(--accent);border-bottom-color:var(--accent);}

        /* ===== HEADER ===== */
        .header{background:linear-gradient(135deg,var(--bg-secondary) 0%,var(--bg-primary) 100%);border-bottom:1px solid var(--bg-tertiary);padding:60px 0;position:relative;overflow:hidden;}
        .header::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at 20% 50%,rgba(245,158,11,.08) 0%,transparent 50%),radial-gradient(ellipse at 80% 50%,rgba(59,130,246,.08) 0%,transparent 50%);pointer-events:none;}
        .header-content{position:relative;z-index:1;}
        .badge{display:inline-flex;align-items:center;gap:8px;background:var(--bg-tertiary);padding:6px 14px;border-radius:20px;font-size:12px;font-weight:500;color:var(--text-secondary);margin-bottom:20px;}
        .badge::before{content:'';width:8px;height:8px;background:var(--accent);border-radius:50%;animation:pulse 2s infinite;}
        @keyframes pulse{0%,100%{opacity:1;transform:scale(1);}50%{opacity:.5;transform:scale(1.2);}}
        h1{font-size:3.2rem;font-weight:700;letter-spacing:-.02em;margin-bottom:16px;background:linear-gradient(135deg,var(--text-primary) 0%,var(--accent) 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;}
        .tagline{font-size:1.2rem;color:var(--text-secondary);margin-bottom:32px;max-width:600px;}
        .highlights{display:flex;flex-wrap:wrap;gap:12px;}
        .highlight-tag{font-family:'JetBrains Mono',monospace;font-size:13px;padding:8px 16px;background:var(--bg-primary);border:1px solid var(--bg-tertiary);border-radius:6px;color:var(--text-secondary);transition:all .3s;}
        .highlight-tag:hover{border-color:var(--accent);color:var(--accent);}

        /* ===== PAGE CONTAINERS ===== */
        .page{display:none;}
        .page.active{display:block;}

        /* ===== SHARED SECTION STYLES ===== */
        section{padding:80px 0;}
        .section-header{margin-bottom:48px;}
        .section-label{font-family:'JetBrains Mono',monospace;font-size:12px;color:var(--accent);text-transform:uppercase;letter-spacing:.1em;margin-bottom:12px;}
        h2{font-size:2rem;font-weight:600;margin-bottom:16px;color:var(--text-primary);}
        h2.bordered{padding-bottom:12px;border-bottom:2px solid var(--bg-tertiary);}
        .section-desc{color:var(--text-secondary);max-width:600px;}
        .section-alt{background:var(--bg-secondary);border-top:1px solid var(--bg-tertiary);border-bottom:1px solid var(--bg-tertiary);}
        h3{font-size:1.25rem;font-weight:600;margin:32px 0 16px;color:var(--text-primary);}
        h4{font-size:1.1rem;font-weight:600;margin:24px 0 12px;color:var(--text-primary);}
        p{margin-bottom:16px;color:var(--text-secondary);}

        /* ===== LEGENDS ===== */
        .legends-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:32px;}
        .legend-card{background:var(--bg-secondary);border-radius:var(--border-radius);padding:28px;border:1px solid var(--bg-tertiary);}
        .legend-card h3{font-size:1rem;font-weight:600;margin:0 0 20px;display:flex;align-items:center;gap:10px;}
        .legend-card h3 span{color:var(--text-muted);font-weight:400;}
        .legend-items{display:flex;flex-direction:column;gap:12px;}
        .legend-item{display:flex;align-items:center;gap:14px;}
        .legend-color{width:24px;height:24px;border-radius:6px;flex-shrink:0;}
        .legend-line{width:40px;height:3px;flex-shrink:0;border-radius:2px;}
        .legend-line.dashed{background:repeating-linear-gradient(90deg,currentColor 0px,currentColor 6px,transparent 6px,transparent 10px);height:2px;}
        .legend-text{font-size:14px;color:var(--text-secondary);}
        .legend-text strong{color:var(--text-primary);}

        /* ===== DIAGRAM ===== */
        .diagram-wrapper{background:var(--bg-primary);border-radius:var(--border-radius);padding:32px;border:1px solid var(--bg-tertiary);overflow-x:auto;}
        .diagram-svg{display:block;margin:0 auto;max-width:100%;}
        .node-text{font-family:'JetBrains Mono',sans-serif;font-size:11px;fill:#1e293b;font-weight:500;}
        .node-subtext{font-family:'Noto Sans TC',sans-serif;font-size:9px;fill:#475569;}
        .connection{fill:none;stroke-width:2;}
        .connection-label{font-family:'JetBrains Mono',monospace;font-size:9px;fill:#94a3b8;}
        .tier-line{stroke:#e2e8f0;stroke-width:1;stroke-dasharray:5,5;}
        .tier-label{font-family:'Noto Sans TC',sans-serif;font-size:10px;fill:#94a3b8;letter-spacing:.05em;}

        /* ===== COMPONENT CARDS ===== */
        .components-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:24px;}
        .component-card{background:var(--bg-secondary);border-radius:var(--border-radius);padding:24px;border:1px solid var(--bg-tertiary);transition:all .3s;position:relative;overflow:hidden;}
        .component-card::before{content:'';position:absolute;top:0;left:0;width:4px;height:100%;background:var(--card-color,var(--accent));}
        .component-card:hover{border-color:var(--card-color,var(--accent));box-shadow:var(--shadow-lg);}
        .component-header{display:flex;align-items:flex-start;gap:16px;margin-bottom:16px;}
        .component-icon{width:48px;height:48px;background:var(--bg-primary);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px;flex-shrink:0;border:1px solid var(--bg-tertiary);}
        .component-title h4{font-size:1.1rem;font-weight:600;margin:0 0 4px;}
        .component-title span{font-size:13px;color:var(--text-muted);}
        .component-desc{color:var(--text-secondary);font-size:14px;margin-bottom:16px;}
        .component-details{list-style:none;margin-bottom:20px;}
        .component-details li{font-size:13px;color:var(--text-secondary);padding:8px 0;border-bottom:1px solid var(--bg-tertiary);display:flex;align-items:flex-start;gap:10px;}
        .component-details li:last-child{border-bottom:none;}
        .component-details li::before{content:'â†’';color:var(--card-color,var(--accent));flex-shrink:0;}
        .tech-tags{display:flex;flex-wrap:wrap;gap:8px;}
        .tech-tag{font-family:'JetBrains Mono',monospace;font-size:11px;padding:4px 10px;background:var(--bg-primary);border:1px solid var(--bg-tertiary);border-radius:4px;color:var(--text-muted);}

        /* ===== FLOW TABS ===== */
        .flow-tabs{display:flex;gap:8px;margin-bottom:32px;flex-wrap:wrap;}
        .flow-tab{padding:12px 24px;background:var(--bg-secondary);border:1px solid var(--bg-tertiary);border-radius:8px;color:var(--text-secondary);font-weight:500;cursor:pointer;transition:all .3s;}
        .flow-tab:hover,.flow-tab.active{background:var(--accent);border-color:var(--accent);color:#fff;}
        .flow-content{display:none;}
        .flow-content.active{display:block;}
        .flow-steps{display:flex;flex-direction:column;}
        .flow-step{display:flex;gap:24px;position:relative;}
        .flow-step::before{content:'';position:absolute;left:23px;top:48px;bottom:0;width:2px;background:var(--bg-tertiary);}
        .flow-step:last-child::before{display:none;}
        .step-number{width:48px;height:48px;background:var(--bg-primary);border:2px solid var(--accent);border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:'JetBrains Mono',monospace;font-weight:600;font-size:16px;color:var(--accent);flex-shrink:0;z-index:1;}
        .step-content{background:var(--bg-secondary);border-radius:var(--border-radius);padding:24px;border:1px solid var(--bg-tertiary);flex:1;margin-bottom:24px;}
        .step-content h4{font-size:1rem;margin:0 0 8px;display:flex;align-items:center;gap:12px;}
        .step-badge{font-family:'JetBrains Mono',monospace;font-size:10px;padding:3px 8px;background:var(--bg-tertiary);border-radius:4px;color:var(--text-muted);}
        .step-content p{margin:0;color:var(--text-secondary);font-size:14px;}

        /* ===== ALGORITHM CARDS (overview) ===== */
        .algorithm-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:24px;}
        .algorithm-card{background:var(--bg-secondary);border-radius:var(--border-radius);padding:28px;border:1px solid var(--bg-tertiary);}
        .algorithm-card h4{font-size:1.1rem;margin-bottom:8px;color:var(--accent);}
        .algorithm-card .subtitle{font-size:12px;color:var(--text-muted);margin-bottom:16px;font-family:'JetBrains Mono',monospace;}
        .algorithm-card p{color:var(--text-secondary);font-size:14px;margin-bottom:16px;}
        .pros-cons{display:grid;grid-template-columns:1fr 1fr;gap:16px;font-size:13px;}
        .pros h5,.cons h5{font-size:12px;color:var(--text-muted);margin-bottom:8px;text-transform:uppercase;letter-spacing:.05em;}
        .pros li{color:var(--success);padding:4px 0;}
        .cons li{color:var(--failure);padding:4px 0;}

        /* ===== DESIGN DECISIONS ===== */
        .decisions-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:24px;}
        .decision-card{background:var(--bg-secondary);border-radius:var(--border-radius);padding:28px;border:1px solid var(--bg-tertiary);}
        .decision-card h4{font-size:1.1rem;margin-bottom:12px;display:flex;align-items:center;gap:12px;}
        .decision-card h4::before{content:'ğŸ’¡';}
        .decision-card p{color:var(--text-secondary);font-size:14px;}
        .highlight{color:var(--accent);font-weight:500;}

        /* ===== CAPACITY ===== */
        .capacity-dashboard{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:40px;}
        .capacity-metric{background:var(--bg-secondary);border-radius:var(--border-radius);padding:24px;border:1px solid var(--bg-tertiary);text-align:center;}
        .metric-value{font-family:'JetBrains Mono',monospace;font-size:2rem;font-weight:600;color:var(--accent);margin-bottom:8px;}
        .metric-label{font-size:13px;color:var(--text-muted);}
        .assumptions-card{background:var(--bg-secondary);border-radius:var(--border-radius);padding:28px;border:1px solid var(--bg-tertiary);}
        .assumptions-card h4{font-size:1rem;margin-bottom:20px;}
        .assumptions-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;}
        .assumption-item{display:flex;align-items:center;gap:12px;font-size:14px;color:var(--text-secondary);}
        .assumption-item::before{content:'â€¢';color:var(--accent);font-size:20px;}

        /* ===== DEEP DIVE â€“ TOC ===== */
        .toc{background:var(--bg-secondary);border-radius:var(--border-radius);padding:24px;margin:40px auto;border:1px solid var(--bg-tertiary);max-width:900px;}
        .toc h3{font-size:14px;text-transform:uppercase;letter-spacing:.05em;color:var(--text-muted);margin-bottom:16px;}
        .toc-list{list-style:none;display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:8px;}
        .toc-list a{color:var(--text-secondary);text-decoration:none;font-size:14px;padding:8px 12px;border-radius:6px;display:block;transition:all .2s;}
        .toc-list a:hover{background:var(--bg-tertiary);color:var(--accent);}

        /* ===== INFO BOXES ===== */
        .info-box{padding:20px 24px;border-radius:var(--border-radius);margin:24px 0;border-left:4px solid;}
        .info-box.concept{background:#eff6ff;border-color:var(--client);}
        .info-box.important{background:var(--accent-light);border-color:var(--accent);}
        .info-box.tip{background:#ecfdf5;border-color:var(--api-server);}
        .info-box.warning{background:#fef2f2;border-color:var(--failure);}
        .info-box h4{margin:0 0 8px;font-size:14px;text-transform:uppercase;letter-spacing:.05em;}
        .info-box.concept h4{color:var(--client);} .info-box.important h4{color:var(--accent);} .info-box.tip h4{color:var(--api-server);} .info-box.warning h4{color:var(--failure);}
        .info-box p{margin:0;font-size:14px;}

        /* ===== CODE BLOCKS (light theme) ===== */
        .code-block{background:#f8fafc;border-radius:var(--border-radius);margin:24px 0;overflow:hidden;border:1px solid #e2e8f0;}
        .code-header{background:#e2e8f0;padding:12px 20px;display:flex;justify-content:space-between;align-items:center;}
        .code-lang{font-family:'JetBrains Mono',monospace;font-size:12px;color:#64748b;}
        .code-title{font-size:13px;color:#475569;}
        .code-block pre{padding:20px;overflow-x:auto;margin:0;}
        .code-block code{font-family:'JetBrains Mono',monospace;font-size:13px;line-height:1.6;color:#1e293b;}
        .code-block .comment{color:#6b7280;} .code-block .keyword{color:#7c3aed;} .code-block .string{color:#059669;} .code-block .number{color:#d97706;} .code-block .function{color:#2563eb;}
        pre,pre *,code,code *{user-select:text!important;-webkit-user-select:text!important;}
        .code-block code::selection,.code-block code *::selection,.code-block pre::selection,.code-block pre *::selection{background:#bfdbfe!important;color:#1e293b!important;}

        /* Inline code */
        code.inline,p code{font-family:'JetBrains Mono',monospace;font-size:.9em;background:var(--bg-secondary);padding:2px 6px;border-radius:4px;color:var(--accent);}

        /* ===== ALGORITHM DEEP DIVE ===== */
        .algorithm-deep{background:var(--bg-secondary);border-radius:var(--border-radius);padding:32px;margin:24px 0;border:1px solid var(--bg-tertiary);}
        .algorithm-deep h3{margin-top:0;display:flex;align-items:center;gap:12px;}
        .algo-badge{font-size:11px;padding:4px 10px;background:var(--accent);color:#fff;border-radius:4px;font-weight:500;}
        .algorithm-visual{background:var(--bg-primary);border-radius:8px;padding:24px;margin:20px 0;border:1px solid var(--bg-tertiary);}
        .algorithm-visual svg{display:block;margin:0 auto;max-width:100%;}

        /* ===== COMPARISON TABLE ===== */
        .comparison-table{width:100%;border-collapse:collapse;margin:24px 0;font-size:14px;}
        .comparison-table th,.comparison-table td{padding:12px 16px;text-align:left;border-bottom:1px solid var(--bg-tertiary);}
        .comparison-table th{background:var(--bg-secondary);font-weight:600;color:var(--text-primary);}
        .comparison-table td{color:var(--text-secondary);}
        .comparison-table tr:hover td{background:var(--bg-secondary);}
        .badge-good{color:var(--success);font-weight:500;} .badge-medium{color:var(--accent);font-weight:500;} .badge-poor{color:var(--failure);font-weight:500;}

        /* ===== KEY POINTS GRID ===== */
        .key-points{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin:24px 0;}
        .key-point{background:var(--bg-secondary);padding:20px;border-radius:var(--border-radius);border:1px solid var(--bg-tertiary);}
        .key-point h5{font-size:13px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.05em;margin-bottom:8px;}
        .key-point .value{font-size:1.5rem;font-weight:700;color:var(--accent);}
        .key-point .desc{font-size:13px;color:var(--text-secondary);margin-top:4px;}

        /* ===== INTERVIEW Q&A ===== */
        .qa-item{border:1px solid var(--bg-tertiary);border-radius:var(--border-radius);margin-bottom:16px;overflow:hidden;}
        .qa-question{background:var(--bg-secondary);padding:16px 20px;font-weight:600;cursor:pointer;display:flex;justify-content:space-between;align-items:center;}
        .qa-question::after{content:'+';font-size:20px;color:var(--accent);transition:transform .2s;}
        .qa-item.open .qa-question::after{transform:rotate(45deg);}
        .qa-answer{padding:0 20px;max-height:0;overflow:hidden;transition:all .3s;}
        .qa-item.open .qa-answer{padding:20px;max-height:2000px;}

        /* ===== STEP-BY-STEP ===== */
        .diagram-section{background:var(--bg-secondary);border-radius:var(--border-radius);padding:32px;margin:24px 0;}
        .step-by-step{counter-reset:step;}
        .step-item{display:flex;gap:20px;margin-bottom:24px;position:relative;}
        .step-item::before{counter-increment:step;content:counter(step);width:32px;height:32px;background:var(--accent);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:14px;flex-shrink:0;}
        .step-item-content h4{margin:0 0 8px;} .step-item-content p{margin:0;font-size:14px;}

        /* Lists */
        ul,ol{margin:16px 0;padding-left:24px;color:var(--text-secondary);}
        li{margin-bottom:8px;}

        /* ===== FOOTER ===== */
        footer{background:var(--bg-secondary);border-top:1px solid var(--bg-tertiary);padding:40px 0;text-align:center;}
        footer p{color:var(--text-muted);font-size:14px;}

        /* ===== RESPONSIVE ===== */
        @media(max-width:768px){
            h1{font-size:2.4rem;}
            section{padding:48px 0;}
            .legends-grid,.components-grid,.decisions-grid,.algorithm-cards{grid-template-columns:1fr;}
            .diagram-wrapper{padding:16px;}
            .flow-step{gap:16px;}
            .step-number{width:40px;height:40px;font-size:14px;}
            .page-tab{padding:0 16px;font-size:13px;}
            .comparison-table{display:block;overflow-x:auto;}
        }
        .back-btn { position: fixed; top: 20px; left: 20px; z-index: 9999; background: var(--bg-secondary); border: 1px solid var(--bg-tertiary); color: var(--text-secondary); padding: 10px 20px; font-size: 0.9rem; cursor: pointer; transition: all 0.3s; text-decoration: none; display: inline-flex; align-items: center; gap: 8px; font-family: inherit; border-radius: 8px; }
        .back-btn:hover { background: var(--text-primary); color: var(--bg-primary); border-color: var(--text-primary); }
    </style>
</head>
<body>
    <a href="../../index.html" class="back-btn">â† è¿”å›é¦–é </a>

<!-- ===== STICKY NAV ===== -->
<nav class="nav">
    <div class="container nav-inner">
        <a href="#" class="nav-brand">ğŸš¦ <span>é™æµå™¨</span>å­¸ç¿’æŒ‡å—</a>
        <div class="page-tabs">
            <button class="page-tab active" onclick="switchPage('overview',this)">ğŸ“Š æ¶æ§‹ç¸½è¦½</button>
            <button class="page-tab" onclick="switchPage('deepdive',this)">ğŸ“š æ·±å…¥å­¸ç¿’</button>
        </div>
    </div>
</nav>

<!-- ===== SHARED HEADER ===== -->
<header class="header">
    <div class="container header-content">
        <div class="badge">ç³»çµ±è¨­è¨ˆæ•™å­¸</div>
        <h1>API é™æµå™¨</h1>
        <p class="tagline">é€éæ™ºæ…§è«‹æ±‚ç¯€æµæ©Ÿåˆ¶ï¼Œä¿è­·æ‚¨çš„æœå‹™å…å—æ¿«ç”¨ï¼Œä¸¦ç¢ºä¿è³‡æºå…¬å¹³åˆ†é…</p>
        <div class="highlights">
            <span class="highlight-tag">ä»¤ç‰Œæ¡¶æ¼”ç®—æ³•</span>
            <span class="highlight-tag">æ»‘å‹•è¦–çª—</span>
            <span class="highlight-tag">åˆ†æ•£å¼å¿«å–</span>
            <span class="highlight-tag">429 è«‹æ±‚éå¤š</span>
            <span class="highlight-tag">IP/ç”¨æˆ¶è­˜åˆ¥</span>
        </div>
    </div>
</header>


<!-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— -->
<!-- â•‘                     ç¬¬ä¸€é ï¼šæ¶æ§‹ç¸½è¦½                              â•‘ -->
<!-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-overview" class="page active">

    <!-- åœ–ä¾‹èªªæ˜ -->
    <section>
        <div class="container">
            <div class="section-header">
                <p class="section-label">è¦–è¦ºæŒ‡å—</p>
                <h2>å…ƒä»¶èˆ‡é€£ç·šåœ–ä¾‹</h2>
                <p class="section-desc">äº†è§£æ¶æ§‹åœ–ä¸­çš„ç¬¦è™Ÿèˆ‡å…¶ä»£è¡¨æ„ç¾©</p>
            </div>
            <div class="legends-grid">
                <div class="legend-card">
                    <h3>ğŸ§© å…ƒä»¶åœ–ä¾‹</h3>
                    <div class="legend-items">
                        <div class="legend-item"><div class="legend-color" style="background:var(--client)"></div><span class="legend-text"><strong>å®¢æˆ¶ç«¯</strong> â€” è«‹æ±‚ç™¼èµ·è€…ï¼ˆç€è¦½å™¨ã€æ‰‹æ©Ÿ Appã€API æ¶ˆè²»è€…ï¼‰</span></div>
                        <div class="legend-item"><div class="legend-color" style="background:var(--load-balancer)"></div><span class="legend-text"><strong>è² è¼‰å‡è¡¡å™¨</strong> â€” æµé‡åˆ†é…å±¤</span></div>
                        <div class="legend-item"><div class="legend-color" style="background:var(--rate-limiter)"></div><span class="legend-text"><strong>é™æµå™¨</strong> â€” æ ¸å¿ƒç¯€æµæ±ºç­–å¼•æ“</span></div>
                        <div class="legend-item"><div class="legend-color" style="background:var(--api-server)"></div><span class="legend-text"><strong>API ä¼ºæœå™¨</strong> â€” å¾Œç«¯æ‡‰ç”¨æœå‹™</span></div>
                        <div class="legend-item"><div class="legend-color" style="background:var(--cache)"></div><span class="legend-text"><strong>å¿«å–</strong> â€” é«˜é€Ÿè«‹æ±‚è¨ˆæ•¸å™¨å„²å­˜</span></div>
                        <div class="legend-item"><div class="legend-color" style="background:var(--rules)"></div><span class="legend-text"><strong>è¦å‰‡å¼•æ“</strong> â€” é™æµç­–ç•¥é…ç½®ä¸­å¿ƒ</span></div>
                        <div class="legend-item"><div class="legend-color" style="background:var(--logging)"></div><span class="legend-text"><strong>æ—¥èªŒæ©Ÿåˆ¶</strong> â€” äº‹ä»¶è¨˜éŒ„ç³»çµ±</span></div>
                        <div class="legend-item"><div class="legend-color" style="background:var(--storage)"></div><span class="legend-text"><strong>æŒä¹…åŒ–å„²å­˜</strong> â€” é•·æœŸè³‡æ–™ä¿å­˜å±¤</span></div>
                    </div>
                </div>
                <div class="legend-card">
                    <h3>â†—ï¸ é€£ç·šèªªæ˜</h3>
                    <div class="legend-items">
                        <div class="legend-item"><div class="legend-line" style="background:var(--sync)"></div><span class="legend-text"><strong>ç°è‰²å¯¦ç·š</strong> â€” åŒæ­¥è«‹æ±‚æµç¨‹</span></div>
                        <div class="legend-item"><div class="legend-line" style="background:var(--success)"></div><span class="legend-text"><strong>ç¶ è‰²å¯¦ç·š</strong> â€” è«‹æ±‚é€šéï¼ˆå…è¨±ï¼‰</span></div>
                        <div class="legend-item"><div class="legend-line" style="background:var(--failure)"></div><span class="legend-text"><strong>ç´…è‰²å¯¦ç·š</strong> â€” è«‹æ±‚æ‹’çµ•ï¼ˆ429 å›æ‡‰ï¼‰</span></div>
                        <div class="legend-item"><div class="legend-line" style="background:var(--rules)"></div><span class="legend-text"><strong>é’è‰²å¯¦ç·š</strong> â€” è¦å‰‡æŸ¥è©¢ / å¿«å–æŸ¥è©¢</span></div>
                        <div class="legend-item"><div class="legend-line dashed" style="color:var(--async)"></div><span class="legend-text"><strong>ç´«è‰²è™›ç·š</strong> â€” éåŒæ­¥å¯«å…¥ / èƒŒæ™¯åŒæ­¥</span></div>
                        <div class="legend-item"><div class="legend-line dashed" style="color:var(--logging)"></div><span class="legend-text"><strong>ç²‰è‰²è™›ç·š</strong> â€” æ—¥èªŒèˆ‡åˆ†æç®¡é“</span></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- æ¶æ§‹åœ– -->
    <section class="section-alt">
        <div class="container">
            <div class="section-header">
                <p class="section-label">ç³»çµ±æ¶æ§‹</p>
                <h2>ç³»çµ±æ¶æ§‹åœ–</h2>
                <p class="section-desc">API é™æµå™¨å…ƒä»¶èˆ‡è³‡æ–™æµçš„è¦–è¦ºåŒ–å‘ˆç¾</p>
            </div>
            <div class="diagram-wrapper">
                <svg class="diagram-svg" viewBox="0 0 1100 720" xmlns="http://www.w3.org/2000/svg">
                    <defs>
                        <marker id="aG" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M0 0L10 5L0 10z" fill="#64748b"/></marker>
                        <marker id="aGr" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M0 0L10 5L0 10z" fill="#22c55e"/></marker>
                        <marker id="aR" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M0 0L10 5L0 10z" fill="#ef4444"/></marker>
                        <marker id="aC" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M0 0L10 5L0 10z" fill="#06b6d4"/></marker>
                        <marker id="aP" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M0 0L10 5L0 10z" fill="#a855f7"/></marker>
                        <marker id="aPk" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M0 0L10 5L0 10z" fill="#ec4899"/></marker>
                        <filter id="ns" x="-20%" y="-20%" width="140%" height="140%"><feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity=".1"/></filter>
                    </defs>
                    <line x1="0" y1="145" x2="1100" y2="145" class="tier-line"/><text x="20" y="140" class="tier-label">é…ç½®å±¤</text>
                    <line x1="0" y1="290" x2="1100" y2="290" class="tier-line"/><text x="20" y="285" class="tier-label">è«‹æ±‚è™•ç†å±¤</text>
                    <line x1="0" y1="470" x2="1100" y2="470" class="tier-line"/><text x="20" y="465" class="tier-label">è¨ˆæ•¸èˆ‡å¿«å–å±¤</text>
                    <line x1="0" y1="600" x2="1100" y2="600" class="tier-line"/><text x="20" y="595" class="tier-label">æŒä¹…åŒ–å±¤</text>
                    <!-- é€£ç·š -->
                    <path d="M550 85L550 155" class="connection" stroke="#06b6d4" marker-end="url(#aC)"/><text x="560" y="120" class="connection-label">åŒæ­¥è¦å‰‡</text>
                    <path d="M550 215L550 300" class="connection" stroke="#06b6d4" marker-end="url(#aC)"/><text x="560" y="258" class="connection-label">æŸ¥è©¢è¦å‰‡</text>
                    <path d="M145 360L230 360" class="connection" stroke="#64748b" marker-end="url(#aG)"/><text x="150" y="350" class="connection-label">HTTP è«‹æ±‚</text>
                    <path d="M350 360L485 360" class="connection" stroke="#64748b" marker-end="url(#aG)"/><text x="380" y="350" class="connection-label">è½‰ç™¼</text>
                    <path d="M615 360L850 360" class="connection" stroke="#22c55e" marker-end="url(#aGr)"/><text x="700" y="350" class="connection-label" style="fill:#22c55e">âœ“ å…è¨±é€šé</text>
                    <path d="M550 405L550 435L80 435L80 380" class="connection" stroke="#ef4444" marker-end="url(#aR)"/><text x="280" y="427" class="connection-label" style="fill:#ef4444">âœ— 429 è«‹æ±‚éå¤š</text>
                    <path d="M600 385L680 385L680 495" class="connection" stroke="#a855f7" stroke-dasharray="5,3" marker-end="url(#aP)"/><text x="690" y="440" class="connection-label">è¨ˆæ•¸å™¨éå¢</text>
                    <path d="M680 555L680 620" class="connection" stroke="#ec4899" stroke-dasharray="5,3" marker-end="url(#aPk)"/><text x="690" y="590" class="connection-label">éåŒæ­¥å¯«å…¥</text>
                    <path d="M610 655L550 655L550 680" class="connection" stroke="#ec4899" stroke-dasharray="5,3" marker-end="url(#aPk)"/><text x="555" y="668" class="connection-label">æŒä¹…åŒ–æ—¥èªŒ</text>
                    <!-- ç¯€é» -->
                    <rect x="480" y="40" width="140" height="45" fill="#fff" stroke="#06b6d4" stroke-width="2" rx="8" filter="url(#ns)"/><rect x="480" y="40" width="4" height="45" fill="#06b6d4" rx="2"/><text x="550" y="65" class="node-text" text-anchor="middle">è¦å‰‡å¼•æ“</text><text x="550" y="78" class="node-subtext" text-anchor="middle">ç­–ç•¥é…ç½®ä¸­å¿ƒ</text>
                    <rect x="480" y="155" width="140" height="60" fill="#fff" stroke="#06b6d4" stroke-width="2" rx="8" filter="url(#ns)"/><rect x="480" y="155" width="4" height="60" fill="#06b6d4" rx="2"/><text x="550" y="183" class="node-text" text-anchor="middle">è¦å‰‡å¿«å–</text><text x="550" y="198" class="node-subtext" text-anchor="middle">è¨˜æ†¶é«”å„²å­˜</text><text x="550" y="210" class="node-subtext" text-anchor="middle" style="font-size:8px;fill:#94a3b8">Redis / æœ¬åœ°å¿«å–</text>
                    <rect x="25" y="335" width="120" height="50" fill="#fff" stroke="#3b82f6" stroke-width="2" rx="8" filter="url(#ns)"/><rect x="25" y="335" width="4" height="50" fill="#3b82f6" rx="2"/><text x="85" y="363" class="node-text" text-anchor="middle">å®¢æˆ¶ç«¯</text><text x="85" y="377" class="node-subtext" text-anchor="middle">ç€è¦½å™¨ / æ‰‹æ©Ÿ / API</text>
                    <rect x="230" y="335" width="120" height="50" fill="#fff" stroke="#8b5cf6" stroke-width="2" rx="8" filter="url(#ns)"/><rect x="230" y="335" width="4" height="50" fill="#8b5cf6" rx="2"/><text x="290" y="363" class="node-text" text-anchor="middle">è² è¼‰å‡è¡¡å™¨</text><text x="290" y="377" class="node-subtext" text-anchor="middle">Nginx / HAProxy</text>
                    <polygon points="550,305 625,360 550,415 475,360" fill="#fff" stroke="#f59e0b" stroke-width="2" filter="url(#ns)"/><text x="550" y="350" class="node-text" text-anchor="middle">API</text><text x="550" y="368" class="node-text" text-anchor="middle">é™æµå™¨</text>
                    <rect x="850" y="335" width="140" height="50" fill="#fff" stroke="#10b981" stroke-width="2" rx="8" filter="url(#ns)"/><rect x="850" y="335" width="4" height="50" fill="#10b981" rx="2"/><text x="920" y="363" class="node-text" text-anchor="middle">API ä¼ºæœå™¨</text><text x="920" y="377" class="node-subtext" text-anchor="middle">æ‡‰ç”¨é‚è¼¯è™•ç†</text>
                    <ellipse cx="680" cy="505" rx="70" ry="15" fill="#fff" stroke="#ef4444" stroke-width="2"/><rect x="610" y="505" width="140" height="40" fill="#fff" stroke="#ef4444" stroke-width="2" stroke-dasharray="0,140,40,140"/><ellipse cx="680" cy="545" rx="70" ry="15" fill="#fff" stroke="#ef4444" stroke-width="2"/><text x="680" y="523" class="node-text" text-anchor="middle">å¿«å–</text><text x="680" y="537" class="node-subtext" text-anchor="middle">é«˜ååé‡å„²å­˜</text>
                    <rect x="610" y="620" width="140" height="55" fill="#fff" stroke="#ec4899" stroke-width="2" rx="8" filter="url(#ns)"/><rect x="610" y="620" width="4" height="55" fill="#ec4899" rx="2"/><text x="680" y="645" class="node-text" text-anchor="middle">æ—¥èªŒæ©Ÿåˆ¶</text><text x="680" y="660" class="node-subtext" text-anchor="middle">äº‹ä»¶è¨˜éŒ„</text><text x="680" y="672" class="node-subtext" text-anchor="middle" style="font-size:8px;fill:#94a3b8">Kafka / Kinesis</text>
                    <ellipse cx="550" cy="690" rx="70" ry="12" fill="#fff" stroke="#6366f1" stroke-width="2"/><rect x="480" y="690" width="140" height="30" fill="#fff" stroke="#6366f1" stroke-width="2" stroke-dasharray="0,140,30,140"/><ellipse cx="550" cy="720" rx="70" ry="12" fill="#fff" stroke="#6366f1" stroke-width="2"/><text x="550" y="705" class="node-text" text-anchor="middle">é•·æœŸå„²å­˜</text><text x="550" y="718" class="node-subtext" text-anchor="middle">ClickHouse / S3</text>
                    <!-- éœ€æ±‚èªªæ˜ -->
                    <rect x="30" y="170" width="180" height="100" fill="#fff" stroke="#e2e8f0" stroke-width="1" rx="8" filter="url(#ns)"/><text x="45" y="195" style="font-family:'JetBrains Mono',monospace;font-size:11px;fill:#f59e0b;font-weight:600">ç³»çµ±éœ€æ±‚</text><text x="45" y="215" style="font-family:'Noto Sans TC',sans-serif;font-size:10px;fill:#475569">â€¢ ä¼ºæœå™¨ç«¯å¯¦ä½œ</text><text x="45" y="230" style="font-family:'Noto Sans TC',sans-serif;font-size:10px;fill:#475569">â€¢ ä¾ IPã€ç”¨æˆ¶ ID ç­‰è­˜åˆ¥</text><text x="45" y="245" style="font-family:'Noto Sans TC',sans-serif;font-size:10px;fill:#475569">â€¢ è¶…é™å›å‚³ 429 HTTP</text><text x="45" y="260" style="font-family:'Noto Sans TC',sans-serif;font-size:10px;fill:#475569">â€¢ æ—¥èªŒè¨˜éŒ„ä¾›åˆ†æ</text>
                </svg>
            </div>
        </div>
    </section>

    <!-- å…ƒä»¶èªªæ˜ -->
    <section>
        <div class="container">
            <div class="section-header"><p class="section-label">å…ƒä»¶ä»‹ç´¹</p><h2>å…ƒä»¶èˆ‡æœå‹™èªªæ˜</h2><p class="section-desc">è©³ç´°èªªæ˜æ¯å€‹ç³»çµ±å…ƒä»¶çš„åŠŸèƒ½èˆ‡è·è²¬</p></div>
            <div class="components-grid">
                <div class="component-card" style="--card-color:var(--client)"><div class="component-header"><div class="component-icon">ğŸ‘¤</div><div class="component-title"><h4>å®¢æˆ¶ç«¯</h4><span>è«‹æ±‚ç™¼èµ·è€…</span></div></div><p class="component-desc">ç™¼èµ· API è«‹æ±‚çš„ä»»ä½•å¯¦é«”ï¼ŒåŒ…å«ç¶²é ç€è¦½å™¨ã€æ‰‹æ©Ÿ Appã€ç¬¬ä¸‰æ–¹ API æ¶ˆè²»è€…ã€‚</p><ul class="component-details"><li>é€éè² è¼‰å‡è¡¡å™¨ç™¼é€ HTTP è«‹æ±‚</li><li>å¾å›æ‡‰ä¸­æ¥æ”¶é™æµæ¨™é ­ï¼ˆX-RateLimit-*ï¼‰</li><li>é‡åˆ° 429 éŒ¯èª¤æ™‚æ‡‰å¯¦ä½œæŒ‡æ•¸é€€é¿é‡è©¦</li><li>å¯é€é IPã€API Keyã€ç”¨æˆ¶ ID æˆ–çµ„åˆè­˜åˆ¥</li></ul><div class="tech-tags"><span class="tech-tag">HTTP/HTTPS</span><span class="tech-tag">REST API</span><span class="tech-tag">gRPC</span></div></div>
                <div class="component-card" style="--card-color:var(--load-balancer)"><div class="component-header"><div class="component-icon">âš–ï¸</div><div class="component-title"><h4>è² è¼‰å‡è¡¡å™¨</h4><span>æµé‡åˆ†é…</span></div></div><p class="component-desc">å°‡é€²å…¥çš„æµé‡åˆ†æ•£åˆ°å¤šå€‹é™æµå™¨å¯¦ä¾‹ï¼Œé¿å…å–®é»ç“¶é ¸ã€‚</p><ul class="component-details"><li>å°‡è«‹æ±‚è·¯ç”±åˆ°å¯ç”¨çš„é™æµå™¨å¯¦ä¾‹</li><li>åŸ·è¡Œå¥åº·æª¢æŸ¥ä¸¦ç§»é™¤æ•…éšœå¯¦ä¾‹</li><li>å¯é€²è¡Œ SSL çµ‚æ­¢è™•ç†</li><li>æ·»åŠ è«‹æ±‚å…ƒè³‡æ–™ï¼ˆå®¢æˆ¶ç«¯ IPã€æ™‚é–“æˆ³è¨˜ï¼‰</li></ul><div class="tech-tags"><span class="tech-tag">Nginx</span><span class="tech-tag">HAProxy</span><span class="tech-tag">AWS ALB</span><span class="tech-tag">Envoy</span></div></div>
                <div class="component-card" style="--card-color:var(--rate-limiter)"><div class="component-header"><div class="component-icon">ğŸš¦</div><div class="component-title"><h4>API é™æµå™¨</h4><span>æ ¸å¿ƒæ±ºç­–å¼•æ“</span></div></div><p class="component-desc">ç³»çµ±æ ¸å¿ƒâ€”â€”æ ¹æ“šè¦å‰‡å’Œè¨ˆæ•¸å™¨æ±ºå®šå…è¨±æˆ–æ‹’çµ•è«‹æ±‚ã€‚</p><ul class="component-details"><li>ä¾æ“šé™æµè¦å‰‡è©•ä¼°è«‹æ±‚</li><li>åœ¨å¿«å–ä¸­éå¢æ¯å€‹è«‹æ±‚çš„è¨ˆæ•¸å™¨</li><li>è¶…é™æ™‚å›å‚³ 429 èˆ‡ Retry-After æ¨™é ­</li><li>æ”¯æ´å¤šç¨®é™æµæ¼”ç®—æ³•</li></ul><div class="tech-tags"><span class="tech-tag">ä»¤ç‰Œæ¡¶</span><span class="tech-tag">æ»‘å‹•è¦–çª—</span><span class="tech-tag">å›ºå®šè¦–çª—</span></div></div>
                <div class="component-card" style="--card-color:var(--api-server)"><div class="component-header"><div class="component-icon">ğŸ–¥ï¸</div><div class="component-title"><h4>API ä¼ºæœå™¨</h4><span>å¾Œç«¯æœå‹™</span></div></div><p class="component-desc">è™•ç†å•†æ¥­é‚è¼¯çš„æ‡‰ç”¨ä¼ºæœå™¨ï¼Œåªåœ¨è«‹æ±‚é€šéé™æµæª¢æŸ¥å¾Œæ‰æœƒæ”¶åˆ°è«‹æ±‚ã€‚</p><ul class="component-details"><li>åªæ¥æ”¶é€šéé™æµçš„è«‹æ±‚</li><li>å°ˆæ³¨è™•ç†å•†æ¥­é‚è¼¯ï¼Œç„¡éœ€é—œå¿ƒé™æµ</li><li>å¯ç¨ç«‹æ°´å¹³æ“´å±•</li><li>å…å—æµé‡å°–å³°èˆ‡æ¿«ç”¨å½±éŸ¿</li></ul><div class="tech-tags"><span class="tech-tag">Node.js</span><span class="tech-tag">Go</span><span class="tech-tag">Java</span><span class="tech-tag">Python</span></div></div>
                <div class="component-card" style="--card-color:var(--rules)"><div class="component-header"><div class="component-icon">âš™ï¸</div><div class="component-title"><h4>è¦å‰‡å¼•æ“</h4><span>ç­–ç•¥é…ç½®</span></div></div><p class="component-desc">ç®¡ç†ä¸¦åˆ†ç™¼é™æµç­–ç•¥ï¼Œæ”¯æ´å‹•æ…‹æ›´æ–°ã€‚</p><ul class="component-details"><li>å®šç¾©æ¯å€‹ç«¯é»ã€ç”¨æˆ¶å±¤ç´šæˆ– IP ç¯„åœçš„é™åˆ¶</li><li>æ”¯æ´è¦å‰‡å„ªå…ˆé †åºèˆ‡è¦†å¯«</li><li>å³æ™‚æ¨é€è¦å‰‡æ›´æ–°åˆ°å¿«å–</li><li>æä¾›ç®¡ç†ä»‹é¢é€²è¡Œé…ç½®</li></ul><div class="tech-tags"><span class="tech-tag">Config Service</span><span class="tech-tag">Feature Flags</span><span class="tech-tag">YAML/JSON</span></div></div>
                <div class="component-card" style="--card-color:var(--rules)"><div class="component-header"><div class="component-icon">ğŸ’¾</div><div class="component-title"><h4>è¦å‰‡å¿«å–</h4><span>è¨˜æ†¶é«”è¦å‰‡å„²å­˜</span></div></div><p class="component-desc">å°‡é™æµè¦å‰‡å„²å­˜åœ¨è¨˜æ†¶é«”ä¸­ï¼Œæä¾›è¶…å¿«é€ŸæŸ¥è©¢ã€‚</p><ul class="component-details"><li>äºæ¯«ç§’ç´šè¦å‰‡æŸ¥è©¢</li><li>è¦å‰‡è®Šæ›´æ™‚èˆ‡è¦å‰‡å¼•æ“åŒæ­¥</li><li>å¯ç‚ºæœ¬åœ°ï¼ˆå–®å¯¦ä¾‹ï¼‰æˆ–åˆ†æ•£å¼</li><li>æ”¯æ´ TTL è‡ªå‹•å¤±æ•ˆ</li></ul><div class="tech-tags"><span class="tech-tag">Redis</span><span class="tech-tag">Memcached</span><span class="tech-tag">æœ¬åœ°è¨˜æ†¶é«”</span></div></div>
                <div class="component-card" style="--card-color:var(--cache)"><div class="component-header"><div class="component-icon">ğŸ“Š</div><div class="component-title"><h4>è¨ˆæ•¸å™¨å¿«å–</h4><span>é«˜ååé‡è¨ˆæ•¸</span></div></div><p class="component-desc">è¿½è¹¤æ¯å€‹å®¢æˆ¶ç«¯çš„è«‹æ±‚æ¬¡æ•¸ï¼Œè¶…ä½å»¶é²æ”¯æ´å³æ™‚æ±ºç­–ã€‚</p><ul class="component-details"><li>åŸå­æ€§éå¢æ“ä½œï¼ˆINCRï¼‰</li><li>Key æ ¼å¼ï¼š{è­˜åˆ¥ç¬¦}:{è¦–çª—}:{ç«¯é»}</li><li>TTL èˆ‡é™æµè¦–çª—æ™‚é•·ç›¸ç¬¦</li><li>éœ€æ”¯æ´æ¯ç§’ 10 è¬+ æ“ä½œ</li></ul><div class="tech-tags"><span class="tech-tag">Redis Cluster</span><span class="tech-tag">Memcached</span><span class="tech-tag">INCR/DECR</span></div></div>
                <div class="component-card" style="--card-color:var(--logging)"><div class="component-header"><div class="component-icon">ğŸ“</div><div class="component-title"><h4>æ—¥èªŒæ©Ÿåˆ¶</h4><span>äº‹ä»¶ä¸²æµè™•ç†</span></div></div><p class="component-desc">éåŒæ­¥æ•ç²æ‰€æœ‰é™æµäº‹ä»¶ï¼Œä¾›åˆ†æèˆ‡æ¿«ç”¨åµæ¸¬ã€‚</p><ul class="component-details"><li>éé˜»å¡å¼éåŒæ­¥æ—¥èªŒ</li><li>è¨˜éŒ„ï¼šå®¢æˆ¶ç«¯ IDã€æ™‚é–“æˆ³è¨˜ã€ç«¯é»ã€æ±ºç­–çµæœ</li><li>æ”¯æ´å³æ™‚æ¿«ç”¨åµæ¸¬å„€è¡¨æ¿</li><li>æ”¯æ´å¤šå€‹ä¸‹æ¸¸æ¶ˆè²»è€…</li></ul><div class="tech-tags"><span class="tech-tag">Kafka</span><span class="tech-tag">Kinesis</span><span class="tech-tag">Fluentd</span></div></div>
                <div class="component-card" style="--card-color:var(--storage)"><div class="component-header"><div class="component-icon">ğŸ—„ï¸</div><div class="component-title"><h4>é•·æœŸå„²å­˜</h4><span>åˆ†æè³‡æ–™åº«</span></div></div><p class="component-desc">æŒä¹…åŒ–æ—¥èªŒä¾›æ­·å²åˆ†æã€åˆè¦èˆ‡æ©Ÿå™¨å­¸ç¿’æ¿«ç”¨åµæ¸¬ã€‚</p><ul class="component-details"><li>é‡å°æ™‚é–“ç¯„åœæŸ¥è©¢æœ€ä½³åŒ–</li><li>èšåˆè³‡æ–™ä¾›å„€è¡¨æ¿èˆ‡å ±è¡¨</li><li>ä¾åˆè¦éœ€æ±‚è¨­å®šä¿ç•™ç­–ç•¥</li><li>æ”¯æ´è¶¨å‹¢åˆ†æèˆ‡å®¹é‡è¦åŠƒ</li></ul><div class="tech-tags"><span class="tech-tag">ClickHouse</span><span class="tech-tag">TimescaleDB</span><span class="tech-tag">S3 + Athena</span></div></div>
            </div>
        </div>
    </section>

    <!-- è«‹æ±‚æµç¨‹ -->
    <section class="section-alt">
        <div class="container">
            <div class="section-header"><p class="section-label">è«‹æ±‚æµç¨‹</p><h2>è«‹æ±‚æµç¨‹è©³ç´°èªªæ˜</h2><p class="section-desc">è«‹æ±‚å¦‚ä½•åœ¨é™æµç³»çµ±ä¸­æµè½‰</p></div>
            <div class="flow-tabs">
                <button class="flow-tab active" onclick="showFlow('allowed',this)">âœ“ è«‹æ±‚å…è¨±</button>
                <button class="flow-tab" onclick="showFlow('rejected',this)">âœ— è«‹æ±‚æ‹’çµ• (429)</button>
                <button class="flow-tab" onclick="showFlow('logging',this)">ğŸ“Š æ—¥èªŒç®¡é“</button>
            </div>
            <div id="flow-allowed" class="flow-content active"><div class="flow-steps">
                <div class="flow-step"><div class="step-number">1</div><div class="step-content"><h4>å®¢æˆ¶ç«¯ç™¼é€è«‹æ±‚ <span class="step-badge">åŒæ­¥</span></h4><p>å®¢æˆ¶ç«¯ç™¼é€å¸¶æœ‰è­˜åˆ¥è³‡è¨Šçš„ HTTP è«‹æ±‚ï¼Œå¦‚ API Keyã€Session Token æˆ– IP ä½å€ã€‚</p></div></div>
                <div class="flow-step"><div class="step-number">2</div><div class="step-content"><h4>è² è¼‰å‡è¡¡å™¨è½‰ç™¼ <span class="step-badge">åŒæ­¥</span></h4><p>å°‡è«‹æ±‚è·¯ç”±åˆ°å¯ç”¨çš„é™æµå™¨å¯¦ä¾‹ï¼Œå¯èƒ½æ·»åŠ  X-Forwarded-For æ¨™é ­ã€‚</p></div></div>
                <div class="flow-step"><div class="step-number">3</div><div class="step-content"><h4>é™æµå™¨æª¢æŸ¥è¦å‰‡ <span class="step-badge">å¿«å–å‘½ä¸­</span></h4><p>æŸ¥è©¢è¦å‰‡å¿«å–å–å¾—é©ç”¨çš„é™æµè¦å‰‡ï¼ˆä¾‹å¦‚ï¼šã€Œæ¨™æº–ç”¨æˆ¶ /api/users æ¯åˆ†é˜ 100 æ¬¡ã€ï¼‰ã€‚</p></div></div>
                <div class="flow-step"><div class="step-number">4</div><div class="step-content"><h4>æª¢æŸ¥ä¸¦éå¢è¨ˆæ•¸ <span class="step-badge">åŸå­æ“ä½œ</span></h4><p>å°è¨ˆæ•¸å™¨å¿«å–åŸ·è¡ŒåŸå­æ€§ GET+INCRã€‚è‹¥è¨ˆæ•¸ &lt; é™åˆ¶ â†’ éå¢ä¸¦ç¹¼çºŒã€‚</p></div></div>
                <div class="flow-step"><div class="step-number">5</div><div class="step-content"><h4>è½‰ç™¼è‡³ API ä¼ºæœå™¨ <span class="step-badge" style="background:var(--success);color:#fff">å…è¨±</span></h4><p>è«‹æ±‚å¸¶è‘—é™æµæ¨™é ­è½‰ç™¼ï¼šX-RateLimit-Limitã€Remainingã€Resetã€‚</p></div></div>
                <div class="flow-step"><div class="step-number">6</div><div class="step-content"><h4>å›æ‡‰å®¢æˆ¶ç«¯ <span class="step-badge">200 OK</span></h4><p>API ä¼ºæœå™¨è™•ç†ä¸¦å›å‚³å›æ‡‰ï¼Œå®Œæˆæ•´å€‹é€±æœŸã€‚</p></div></div>
            </div></div>
            <div id="flow-rejected" class="flow-content"><div class="flow-steps">
                <div class="flow-step"><div class="step-number">1</div><div class="step-content"><h4>å®¢æˆ¶ç«¯ç™¼é€è«‹æ±‚ <span class="step-badge">åŒæ­¥</span></h4><p>å®¢æˆ¶ç«¯ç™¼é€è«‹æ±‚ï¼Œä¸çŸ¥é“å¯èƒ½æœƒè§¸åŠé™åˆ¶ã€‚</p></div></div>
                <div class="flow-step"><div class="step-number">2</div><div class="step-content"><h4>è² è¼‰å‡è¡¡å™¨è½‰ç™¼ <span class="step-badge">åŒæ­¥</span></h4><p>è² è¼‰å‡è¡¡å™¨æ­£å¸¸è·¯ç”±â€”â€”å®ƒä¸åšé™æµã€‚</p></div></div>
                <div class="flow-step"><div class="step-number">3</div><div class="step-content"><h4>è¨ˆæ•¸è¶…éé™åˆ¶ <span class="step-badge" style="background:var(--failure);color:#fff">è§¸åŠé™åˆ¶</span></h4><p>è¨ˆæ•¸å™¨å¿«å–é¡¯ç¤ºè¨ˆæ•¸ â‰¥ é™åˆ¶ï¼ˆä¾‹å¦‚ 101 vs é™åˆ¶ 100ï¼‰ã€‚è«‹æ±‚è¢«æ‹’çµ•ã€‚</p></div></div>
                <div class="flow-step"><div class="step-number">4</div><div class="step-content"><h4>å›å‚³ 429 å›æ‡‰ <span class="step-badge" style="background:var(--failure);color:#fff">æ‹’çµ•</span></h4><p>å›å‚³ HTTP 429ï¼Œå¸¶æœ‰ Retry-After æ¨™é ­å’Œ X-RateLimit-Reset æ™‚é–“æˆ³è¨˜ã€‚</p></div></div>
                <div class="flow-step"><div class="step-number">5</div><div class="step-content"><h4>è¨˜éŒ„æ‹’çµ•äº‹ä»¶ <span class="step-badge">éåŒæ­¥</span></h4><p>éåŒæ­¥è¨˜éŒ„æ‹’çµ•äº‹ä»¶ï¼Œä¾›ç›£æ§èˆ‡æ¿«ç”¨åµæ¸¬ã€‚</p></div></div>
            </div></div>
            <div id="flow-logging" class="flow-content"><div class="flow-steps">
                <div class="flow-step"><div class="step-number">1</div><div class="step-content"><h4>äº‹ä»¶ç”¢ç”Ÿ <span class="step-badge">éåŒæ­¥</span></h4><p>æ¯å€‹æ±ºç­–éƒ½ç”¢ç”Ÿäº‹ä»¶ï¼šå®¢æˆ¶ç«¯ IDã€IPã€ç«¯é»ã€æ™‚é–“æˆ³è¨˜ã€æ±ºç­–ã€è¨ˆæ•¸ã€é™åˆ¶ã€‚</p></div></div>
                <div class="flow-step"><div class="step-number">2</div><div class="step-content"><h4>æ‰¹æ¬¡ç·©è¡ <span class="step-badge">ç·©è¡å€</span></h4><p>äº‹ä»¶åœ¨æœ¬åœ°ç·©è¡å€æ‰¹æ¬¡è™•ç†ã€‚æ¯ N ç§’æˆ–é”åˆ°å¤§å°é–¾å€¼æ™‚åˆ·æ–°ã€‚</p></div></div>
                <div class="flow-step"><div class="step-number">3</div><div class="step-content"><h4>ä¸²æµè‡³è¨Šæ¯ä½‡åˆ— <span class="step-badge">KAFKA</span></h4><p>ç™¼å¸ƒè‡³ Kafka/Kinesis ç¢ºä¿å¯é å‚³éï¼Œèˆ‡ä¸‹æ¸¸è§£è€¦ã€‚</p></div></div>
                <div class="flow-step"><div class="step-number">4</div><div class="step-content"><h4>æŒä¹…åŒ–è‡³å„²å­˜ <span class="step-badge">åˆ†æ</span></h4><p>æ¶ˆè²»è€…å¯«å…¥æ™‚åºè³‡æ–™åº«ï¼Œä¾›å„€è¡¨æ¿ã€å‘Šè­¦å’Œè¶¨å‹¢åˆ†æã€‚</p></div></div>
            </div></div>
        </div>
    </section>

    <!-- æ¼”ç®—æ³•æ¦‚è¦½ -->
    <section>
        <div class="container">
            <div class="section-header"><p class="section-label">æ¼”ç®—æ³•</p><h2>é™æµæ¼”ç®—æ³•</h2><p class="section-desc">å¸¸è¦‹æ¼”ç®—æ³•èˆ‡å…¶æ¬Šè¡¡â€”â€”è©³ç´°ç¨‹å¼ç¢¼è«‹è¦‹æ·±å…¥å­¸ç¿’</p></div>
            <div class="algorithm-cards">
                <div class="algorithm-card"><h4>ä»¤ç‰Œæ¡¶ (Token Bucket)</h4><p class="subtitle">æœ€ç†±é–€é¸æ“‡</p><p>æ¡¶ä¸­æŒæœ‰ä»¥å›ºå®šé€Ÿç‡æ·»åŠ çš„ä»¤ç‰Œã€‚æ¯å€‹è«‹æ±‚æ¶ˆè€—ä¸€å€‹ä»¤ç‰Œã€‚å…è¨±çªç™¼æµé‡ç›´åˆ°æ¡¶å®¹é‡ã€‚</p><div class="pros-cons"><div class="pros"><h5>âœ“ å„ªé»</h5><ul><li>â€¢ å…è¨±å¯æ§çªç™¼</li><li>â€¢ è¨˜æ†¶é«”æ•ˆç‡é«˜</li><li>â€¢ å¯¦ä½œç°¡å–®</li></ul></div><div class="cons"><h5>âœ— ç¼ºé»</h5><ul><li>â€¢ éœ€èª¿æ ¡æ¡¶å¤§å°</li><li>â€¢ æœ‰å…©å€‹åƒæ•¸è¦è¨­å®š</li></ul></div></div></div>
                <div class="algorithm-card"><h4>æ»‘å‹•è¦–çª—æ—¥èªŒ (Sliding Window Log)</h4><p class="subtitle">æœ€ç²¾ç¢º</p><p>å„²å­˜æ¯å€‹è«‹æ±‚çš„æ™‚é–“æˆ³è¨˜ã€‚è¨ˆç®—æ»‘å‹•è¦–çª—å…§çš„è«‹æ±‚æ•¸ã€‚éå¸¸ç²¾ç¢ºä½†æ¶ˆè€—è¼ƒå¤šè¨˜æ†¶é«”ã€‚</p><div class="pros-cons"><div class="pros"><h5>âœ“ å„ªé»</h5><ul><li>â€¢ éå¸¸ç²¾ç¢º</li><li>â€¢ ç„¡é‚Šç•Œå•é¡Œ</li><li>â€¢ å¹³æ»‘é™æµ</li></ul></div><div class="cons"><h5>âœ— ç¼ºé»</h5><ul><li>â€¢ è¨˜æ†¶é«”ä½¿ç”¨é‡é«˜</li><li>â€¢ è¨ˆç®—é‡è¼ƒå¤§</li></ul></div></div></div>
                <div class="algorithm-card"><h4>å›ºå®šè¦–çª—è¨ˆæ•¸ (Fixed Window)</h4><p class="subtitle">æœ€ç°¡å–®</p><p>å°‡æ™‚é–“åŠƒåˆ†ç‚ºå›ºå®šè¦–çª—ï¼Œæ¯å€‹è¦–çª—æœ‰ç¨ç«‹è¨ˆæ•¸å™¨ï¼Œåœ¨é‚Šç•Œé‡ç½®ã€‚ç°¡å–®ä½†é‚Šç•Œå¯èƒ½æœ‰ 2 å€çªç™¼ã€‚</p><div class="pros-cons"><div class="pros"><h5>âœ“ å„ªé»</h5><ul><li>â€¢ éå¸¸ç°¡å–®</li><li>â€¢ ä½è¨˜æ†¶é«”</li><li>â€¢ æ“ä½œå¿«é€Ÿ</li></ul></div><div class="cons"><h5>âœ— ç¼ºé»</h5><ul><li>â€¢ é‚Šç•Œå°–å³°å•é¡Œ</li><li>â€¢ è¼ƒä¸å¹³æ»‘</li></ul></div></div></div>
                <div class="algorithm-card"><h4>æ»‘å‹•è¦–çª—è¨ˆæ•¸ (Sliding Window Counter)</h4><p class="subtitle">æœ€ä½³å¹³è¡¡</p><p>ä½¿ç”¨ç•¶å‰èˆ‡å‰ä¸€è¦–çª—è¨ˆæ•¸çš„åŠ æ¬Šå¹³å‡ã€‚åœ¨æ•ˆç‡èˆ‡ç²¾ç¢ºåº¦é–“å–å¾—è‰¯å¥½å¹³è¡¡ã€‚</p><div class="pros-cons"><div class="pros"><h5>âœ“ å„ªé»</h5><ul><li>â€¢ ç²¾ç¢ºåº¦ä½³</li><li>â€¢ ä½è¨˜æ†¶é«”</li><li>â€¢ å¹³æ»‘é‚Šç•Œ</li></ul></div><div class="cons"><h5>âœ— ç¼ºé»</h5><ul><li>â€¢ åƒ…ç‚ºè¿‘ä¼¼å€¼</li><li>â€¢ ç¨å¾®è¤‡é›œ</li></ul></div></div></div>
            </div>
        </div>
    </section>

    <!-- è¨­è¨ˆæ±ºç­– -->
    <section class="section-alt">
        <div class="container">
            <div class="section-header"><p class="section-label">è¨­è¨ˆæ±ºç­–</p><h2>é—œéµæ¶æ§‹é¸æ“‡</h2><p class="section-desc">ç†è§£æ¯å€‹è¨­è¨ˆæ±ºç­–èƒŒå¾Œçš„åŸå› </p></div>
            <div class="decisions-grid">
                <div class="decision-card"><h4>ä¼ºæœå™¨ç«¯é™æµ</h4><p>å¯¦ä½œæ–¼<span class="highlight">ä¼ºæœå™¨ç«¯</span>ï¼Œå› ç‚ºå®¢æˆ¶ç«¯ä¸å¯ä¿¡ä»»ã€‚æƒ¡æ„æ”»æ“Šè€…å¯ç¹éå®¢æˆ¶ç«¯æ§åˆ¶ã€‚</p></div>
                <div class="decision-card"><h4>åˆ†æ•£å¼è¨ˆæ•¸å™¨å¿«å–</h4><p><span class="highlight">Redis Cluster</span> ç¢ºä¿æ‰€æœ‰å¯¦ä¾‹é–“é™åˆ¶ä¸€è‡´ã€‚å¦å‰‡æ¯å€‹å¯¦ä¾‹å„å…è¨± N å€é™åˆ¶ã€‚</p></div>
                <div class="decision-card"><h4>éåŒæ­¥æ—¥èªŒç®¡é“</h4><p>æ—¥èªŒé€éè¨Šæ¯ä½‡åˆ—<span class="highlight">éåŒæ­¥</span>è™•ç†ã€‚é—œéµè·¯å¾‘ä¿æŒå¿«é€Ÿï¼ˆ&lt;5msï¼‰ã€‚</p></div>
                <div class="decision-card"><h4>è¦å‰‡å¿«å–åˆ†é›¢</h4><p>è¦å‰‡èˆ‡è¨ˆæ•¸å™¨<span class="highlight">åˆ†é–‹å¿«å–</span>â€”â€”è¦å‰‡è®Šæ›´ä¸é »ç¹ï¼Œå¯ç©æ¥µå¿«å–ã€‚</p></div>
                <div class="decision-card"><h4>429 æ­é… Retry-After</h4><p>HTTP <span class="highlight">429 Too Many Requests</span> æ­é… Retry-After é˜²æ­¢ã€Œé©šç¾¤æ•ˆæ‡‰ã€é‡è©¦ã€‚</p></div>
                <div class="decision-card"><h4>å¤šé‡è­˜åˆ¥æ”¯æ´</h4><p>æ”¯æ´ä¾ <span class="highlight">IPã€ç”¨æˆ¶ IDã€API Key</span> é™æµâ€”â€”åŒ¿åç”¨ IPï¼Œå·²ç™»å…¥ç”¨ ID ç¢ºä¿å…¬å¹³ã€‚</p></div>
                <div class="decision-card"><h4>é™æµå™¨ç½®æ–¼å¾Œç«¯ä¹‹å‰</h4><p>æ”¾åœ¨<span class="highlight">å¾Œç«¯ä¼ºæœå™¨ä¹‹å‰</span>â€”â€”ææ—©æ‹’çµ•ï¼Œé¿å…æ¶ˆè€—å¾Œç«¯è³‡æºã€‚</p></div>
                <div class="decision-card"><h4>å„ªé›…é™ç´š</h4><p>å¿«å–ä¸å¯ç”¨æ™‚<span class="highlight">é–‹æ”¾æ”¾è¡Œ</span>â€”â€”å¯ç”¨æ€§å„ªå…ˆæ–¼åš´æ ¼é™åˆ¶ã€‚å‘Šè­¦é€šçŸ¥ç¶­é‹äººå“¡ã€‚</p></div>
            </div>
        </div>
    </section>

    <!-- å®¹é‡ä¼°ç®— -->
    <section>
        <div class="container">
            <div class="section-header"><p class="section-label">å®¹é‡è¦åŠƒ</p><h2>å®¹é‡ä¼°ç®—</h2><p class="section-desc">ä¸­å‹ API æœå‹™çš„ç¯„ä¾‹è¨ˆç®—</p></div>
            <div class="capacity-dashboard">
                <div class="capacity-metric"><div class="metric-value">10M</div><div class="metric-label">æ—¥æ´»èºç”¨æˆ¶</div></div>
                <div class="capacity-metric"><div class="metric-value">100M</div><div class="metric-label">æ¯æ—¥ API è«‹æ±‚æ•¸</div></div>
                <div class="capacity-metric"><div class="metric-value">1.2K</div><div class="metric-label">å¹³å‡ QPS</div></div>
                <div class="capacity-metric"><div class="metric-value">5K</div><div class="metric-label">å°–å³° QPS</div></div>
                <div class="capacity-metric"><div class="metric-value">&lt;5ms</div><div class="metric-label">P99 å»¶é²ç›®æ¨™</div></div>
            </div>
            <div class="assumptions-card"><h4>ğŸ“Š å‡è¨­èˆ‡è¨ˆç®—</h4><div class="assumptions-list">
                <div class="assumption-item">æ¯ç”¨æˆ¶æ¯æ—¥å¹³å‡ 10 æ¬¡è«‹æ±‚</div>
                <div class="assumption-item">å°–å³°æµé‡ = å¹³å‡çš„ 4 å€</div>
                <div class="assumption-item">1 åˆ†é˜æ»‘å‹•è¦–çª—</div>
                <div class="assumption-item">å…è²»ç”¨æˆ¶æ¯åˆ†é˜ 100 æ¬¡é™åˆ¶</div>
                <div class="assumption-item">ä»˜è²»ç”¨æˆ¶æ¯åˆ†é˜ 1000 æ¬¡é™åˆ¶</div>
                <div class="assumption-item">Redis æ¯å€‹è¨ˆæ•¸å™¨ Key ç´„ 50 bytes</div>
                <div class="assumption-item">æœ€å¤§ 1000 è¬æ´»èº Key â‰ˆ 500MB Redis</div>
                <div class="assumption-item">3 ç¯€é» Redis Cluster ç¢ºä¿é«˜å¯ç”¨</div>
                <div class="assumption-item">æ¯ç­†æ—¥èªŒç´„ 2KB â†’ æ¯æ—¥ 200GB</div>
                <div class="assumption-item">90 å¤©ä¿ç•™ = 18TB å„²å­˜</div>
            </div></div>
        </div>
    </section>
</div>


<!-- â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— -->
<!-- â•‘                    ç¬¬äºŒé ï¼šæ·±å…¥å­¸ç¿’                               â•‘ -->
<!-- â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-deepdive" class="page">

    <!-- ç›®éŒ„ -->
    <div class="toc">
        <h3>ğŸ“‘ ç›®éŒ„</h3>
        <ul class="toc-list">
            <li><a href="#dd-why" onclick="scrollDD(event,'dd-why')">1. ç‚ºä»€éº¼éœ€è¦é™æµï¼Ÿ</a></li>
            <li><a href="#dd-algo" onclick="scrollDD(event,'dd-algo')">2. æ¼”ç®—æ³•æ·±åº¦è§£æ</a></li>
            <li><a href="#dd-impl" onclick="scrollDD(event,'dd-impl')">3. å¯¦ä½œç´°ç¯€</a></li>
            <li><a href="#dd-dist" onclick="scrollDD(event,'dd-dist')">4. åˆ†æ•£å¼é™æµ</a></li>
            <li><a href="#dd-redis" onclick="scrollDD(event,'dd-redis')">5. Redis å¯¦ä½œ</a></li>
            <li><a href="#dd-headers" onclick="scrollDD(event,'dd-headers')">6. HTTP æ¨™é ­èˆ‡å›æ‡‰</a></li>
            <li><a href="#dd-strat" onclick="scrollDD(event,'dd-strat')">7. é™æµç­–ç•¥</a></li>
            <li><a href="#dd-qa" onclick="scrollDD(event,'dd-qa')">8. é¢è©¦é¡Œåº«</a></li>
        </ul>
    </div>

    <!-- 1. ç‚ºä»€éº¼éœ€è¦é™æµ -->
    <section id="dd-why"><div class="container-narrow">
        <h2 class="bordered">1. ç‚ºä»€éº¼éœ€è¦é™æµï¼Ÿ</h2>
        <p>é™æµæ§åˆ¶å®¢æˆ¶ç«¯ç™¼é€è«‹æ±‚çš„é€Ÿç‡ã€‚å®ƒå°æ–¼ç³»çµ±ç©©å®šæ€§ã€é˜²æ­¢æ¿«ç”¨å’Œå…¬å¹³è³‡æºåˆ†é…è‡³é—œé‡è¦ã€‚</p>
        <div class="info-box concept"><h4>ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µ</h4><p>é™æµå™¨å°±åƒå®ˆé–€å“¡ï¼Œç›£æ§ä¸¦æ§åˆ¶é€²å…¥çš„è«‹æ±‚æµé‡ï¼Œæ‹’çµ•è¶…éé–¾å€¼çš„è«‹æ±‚ä»¥ä¿è­·å¾Œç«¯æœå‹™ã€‚</p></div>
        <h3>ä¸»è¦ç›®æ¨™</h3>
        <ul><li><strong>é˜²æ­¢ DoS æ”»æ“Š</strong> â€” é˜»æ­¢æƒ¡æ„æµé‡å£“å®æœå‹™</li><li><strong>é™ä½æˆæœ¬</strong> â€” é™åˆ¶æœ‰å•é¡Œå®¢æˆ¶ç«¯çš„è³‡æºæ¶ˆè€—</li><li><strong>é˜²æ­¢éè¼‰</strong> â€” åœ¨é«˜è² è¼‰ä¸‹ä¿æŒå¾Œç«¯å›æ‡‰èƒ½åŠ›</li><li><strong>å…¬å¹³åˆ†é…</strong> â€” ç¢ºä¿æ‰€æœ‰ç”¨æˆ¶ç²å¾—å…¬å¹³çš„ API é…é¡</li></ul>
        <h3>åœ¨å“ªè£¡å¯¦ä½œï¼Ÿ</h3>
        <div class="key-points">
            <div class="key-point"><h5>å®¢æˆ¶ç«¯</h5><div class="value">âŒ</div><div class="desc">ä¸å¯é  â€” å¯è¢«ç¹é</div></div>
            <div class="key-point"><h5>API é–˜é“</h5><div class="value">âœ…</div><div class="desc">é›†ä¸­ç®¡ç†ï¼Œæ˜“æ–¼ç¶­è­·</div></div>
            <div class="key-point"><h5>ä¸­ä»‹è»Ÿé«”</h5><div class="value">âœ…</div><div class="desc">ç´°ç²’åº¦æ§åˆ¶</div></div>
            <div class="key-point"><h5>è² è¼‰å‡è¡¡å™¨</h5><div class="value">âš ï¸</div><div class="desc">åŸºæœ¬åŠŸèƒ½ï¼Œå½ˆæ€§æœ‰é™</div></div>
        </div>
        <div class="info-box important"><h4>ğŸ¯ é—œéµé‡é»</h4><p>æ°¸é åœ¨ä¼ºæœå™¨ç«¯å¯¦ä½œã€‚å®¢æˆ¶ç«¯é™æµåªæ˜¯ç¦®è²Œæ€§æªæ–½â€”â€”å¾ˆå®¹æ˜“è¢«ç¹éã€‚</p></div>
    </div></section>

    <!-- 2. æ¼”ç®—æ³•æ·±åº¦è§£æ -->
    <section id="dd-algo" class="section-alt"><div class="container-narrow">
        <h2 class="bordered">2. æ¼”ç®—æ³•æ·±åº¦è§£æ</h2>
        <p>å››ç¨®ä¸»è¦æ¼”ç®—æ³•ï¼Œå„æœ‰åœ¨ç²¾ç¢ºåº¦ã€è¨˜æ†¶é«”å’Œè¤‡é›œåº¦ä¸Šçš„æ¬Šè¡¡ã€‚</p>

        <!-- ä»¤ç‰Œæ¡¶ -->
        <div class="algorithm-deep">
            <h3>ä»¤ç‰Œæ¡¶ (Token Bucket) <span class="algo-badge">æœ€ç†±é–€</span></h3>
            <p>æ¡¶ä¸­æŒæœ‰ä»¥å›ºå®šé€Ÿç‡æ·»åŠ çš„ä»¤ç‰Œã€‚æ¯å€‹è«‹æ±‚æ¶ˆè€—ä¸€å€‹ä»¤ç‰Œã€‚æ¡¶ç©ºæ™‚ â†’ æ‹’çµ•è«‹æ±‚ã€‚å…è¨±çªç™¼æµé‡ç›´åˆ°æ¡¶å®¹é‡ã€‚</p>
            <div class="algorithm-visual"><svg viewBox="0 0 600 200" xmlns="http://www.w3.org/2000/svg">
                <defs><marker id="agr2" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto"><path d="M0 0L10 5L0 10z" fill="#10b981"/></marker><marker id="abl" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto"><path d="M0 0L10 5L0 10z" fill="#3b82f6"/></marker></defs>
                <rect x="250" y="40" width="100" height="120" fill="#f8fafc" stroke="#e2e8f0" stroke-width="2" rx="8"/><text x="300" y="25" text-anchor="middle" font-size="12" fill="#64748b">æ¡¶ï¼ˆå®¹é‡ï¼š10ï¼‰</text>
                <circle cx="275" cy="130" r="12" fill="#f59e0b"/><circle cx="300" cy="130" r="12" fill="#f59e0b"/><circle cx="325" cy="130" r="12" fill="#f59e0b"/><circle cx="275" cy="100" r="12" fill="#f59e0b"/><circle cx="300" cy="100" r="12" fill="#f59e0b"/><circle cx="325" cy="100" r="12" fill="#f59e0b"/><circle cx="287" cy="70" r="12" fill="#f59e0b" opacity=".5"/>
                <text x="300" y="175" text-anchor="middle" font-size="11" fill="#64748b">å¯ç”¨ä»¤ç‰Œï¼š6 å€‹</text>
                <path d="M150 100L240 100" stroke="#10b981" stroke-width="2" marker-end="url(#agr2)"/><text x="100" y="95" font-size="11" fill="#10b981">è£œå……</text><text x="100" y="110" font-size="10" fill="#64748b">2 ä»¤ç‰Œ/ç§’</text>
                <path d="M360 100L450 100" stroke="#3b82f6" stroke-width="2" marker-end="url(#abl)"/><text x="470" y="95" font-size="11" fill="#3b82f6">è«‹æ±‚</text><text x="470" y="110" font-size="10" fill="#64748b">-1 ä»¤ç‰Œ</text>
            </svg></div>
            <h4>åƒæ•¸</h4>
            <ul><li><code>bucket_size</code> â€” æœ€å¤§ä»¤ç‰Œæ•¸ï¼ˆçªç™¼å®¹é‡ï¼‰</li><li><code>refill_rate</code> â€” æ¯ç§’æ·»åŠ çš„ä»¤ç‰Œæ•¸</li></ul>
            <div class="code-block"><div class="code-header"><span class="code-lang">Python</span><span class="code-title">token_bucket.py</span></div><pre><code><span class="keyword">class</span> <span class="function">TokenBucket</span>:
    <span class="keyword">def</span> <span class="function">__init__</span>(self, capacity, refill_rate):
        self.capacity = capacity
        self.tokens = capacity
        self.refill_rate = refill_rate
        self.last_refill = time.time()

    <span class="keyword">def</span> <span class="function">allow_request</span>(self):
        <span class="comment"># æ ¹æ“šç¶“éæ™‚é–“è£œå……ä»¤ç‰Œ</span>
        now = time.time()
        elapsed = now - self.last_refill
        self.tokens = min(
            self.capacity,
            self.tokens + elapsed * self.refill_rate
        )
        self.last_refill = now

        <span class="comment"># æª¢æŸ¥è«‹æ±‚æ˜¯å¦å¯ä»¥æ”¾è¡Œ</span>
        <span class="keyword">if</span> self.tokens >= <span class="number">1</span>:
            self.tokens -= <span class="number">1</span>
            <span class="keyword">return</span> <span class="keyword">True</span>
        <span class="keyword">return</span> <span class="keyword">False</span></code></pre></div>
            <div class="info-box tip"><h4>âœ… é©ç”¨å ´æ™¯</h4><p>é©åˆå…è¨±çŸ­æœŸçªç™¼åŒæ™‚ç¶­æŒç©©å®šé€Ÿç‡ã€‚AWSã€Stripe åŠå¤§å¤šæ•¸é›²ç«¯ä¾›æ‡‰å•†éƒ½ä½¿ç”¨æ­¤æ¼”ç®—æ³•ã€‚</p></div>
        </div>

        <!-- æ¼æ¡¶ -->
        <div class="algorithm-deep">
            <h3>æ¼æ¡¶ (Leaky Bucket)</h3>
            <p>ä»¥å›ºå®šé€Ÿç‡è™•ç†è«‹æ±‚ã€‚æƒ³åƒæ°´ä»¥æ†å®šé€Ÿç‡å¾æ¡¶ä¸­æ¼å‡ºâ€”â€”å®Œå…¨å¹³æ»‘çªç™¼æµé‡ã€‚</p>
            <div class="algorithm-visual"><svg viewBox="0 0 600 200" xmlns="http://www.w3.org/2000/svg">
                <defs><marker id="ag3" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto"><path d="M0 0L10 5L0 10z" fill="#64748b"/></marker><marker id="agr3" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto"><path d="M0 0L10 5L0 10z" fill="#10b981"/></marker><marker id="ar3" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto"><path d="M0 0L10 5L0 10z" fill="#ef4444"/></marker></defs>
                <path d="M250 40L250 140L260 150L340 150L350 140L350 40Z" fill="#f8fafc" stroke="#e2e8f0" stroke-width="2"/><text x="300" y="25" text-anchor="middle" font-size="12" fill="#64748b">ä½‡åˆ— (FIFO)</text>
                <rect x="255" y="80" width="90" height="65" fill="#3b82f6" opacity=".3" rx="4"/><text x="300" y="120" text-anchor="middle" font-size="10" fill="#3b82f6">æ’éšŠä¸­çš„è«‹æ±‚</text>
                <path d="M150 60L240 60" stroke="#64748b" stroke-width="2" marker-end="url(#ag3)"/><text x="120" y="55" font-size="11" fill="#64748b">è¼¸å…¥</text><text x="100" y="70" font-size="10" fill="#94a3b8">è®Šå‹•é€Ÿç‡</text>
                <path d="M300 155L300 190" stroke="#10b981" stroke-width="2" marker-end="url(#agr3)"/><text x="320" y="180" font-size="11" fill="#10b981">è¼¸å‡º</text><text x="320" y="195" font-size="10" fill="#64748b">å›ºå®šé€Ÿç‡</text>
                <path d="M355 60L420 60" stroke="#ef4444" stroke-width="2" stroke-dasharray="4,2" marker-end="url(#ar3)"/><text x="430" y="55" font-size="11" fill="#ef4444">æº¢å‡º</text><text x="430" y="70" font-size="10" fill="#64748b">ï¼ˆæ‹’çµ•ï¼‰</text>
            </svg></div>
            <h4>èˆ‡ä»¤ç‰Œæ¡¶çš„é—œéµå·®ç•°</h4>
            <p>æ¼æ¡¶ä»¥<strong>æ†å®šé€Ÿç‡</strong>è™•ç†è«‹æ±‚ï¼Œå¹³æ»‘çªç™¼ã€‚ä»¤ç‰Œæ¡¶å‰‡<em>å…è¨±</em>çªç™¼ç›´åˆ°æ¡¶å¤§å°ã€‚</p>
        </div>

        <!-- å›ºå®šè¦–çª— -->
        <div class="algorithm-deep">
            <h3>å›ºå®šè¦–çª—è¨ˆæ•¸ (Fixed Window) <span class="algo-badge">æœ€ç°¡å–®</span></h3>
            <p>å°‡æ™‚é–“åŠƒåˆ†ç‚ºå›ºå®šè¦–çª—ï¼Œæ¯å€‹è¦–çª—æœ‰ç¨ç«‹è¨ˆæ•¸å™¨ã€‚ç°¡å–®ä½†æœ‰ã€Œé‚Šç•Œå•é¡Œã€ã€‚</p>
            <div class="algorithm-visual"><svg viewBox="0 0 600 180" xmlns="http://www.w3.org/2000/svg">
                <line x1="50" y1="100" x2="550" y2="100" stroke="#e2e8f0" stroke-width="2"/>
                <rect x="50" y="50" width="150" height="50" fill="#10b981" opacity=".2" stroke="#10b981"/><text x="125" y="80" text-anchor="middle" font-size="12" fill="#10b981">45 æ¬¡è«‹æ±‚</text><text x="125" y="120" text-anchor="middle" font-size="10" fill="#64748b">12:00 â€“ 12:01</text>
                <rect x="200" y="50" width="150" height="50" fill="#ef4444" opacity=".2" stroke="#ef4444"/><text x="275" y="80" text-anchor="middle" font-size="12" fill="#ef4444">100 æ¬¡è«‹æ±‚ âš ï¸</text><text x="275" y="120" text-anchor="middle" font-size="10" fill="#64748b">12:01 â€“ 12:02</text>
                <rect x="350" y="50" width="150" height="50" fill="#10b981" opacity=".2" stroke="#10b981"/><text x="425" y="80" text-anchor="middle" font-size="12" fill="#10b981">30 æ¬¡è«‹æ±‚</text><text x="425" y="120" text-anchor="middle" font-size="10" fill="#64748b">12:02 â€“ 12:03</text>
                <line x1="50" y1="35" x2="550" y2="35" stroke="#ef4444" stroke-width="1" stroke-dasharray="4,2"/><text x="555" y="38" font-size="10" fill="#ef4444">é™åˆ¶ï¼š100/åˆ†é˜</text>
                <rect x="175" y="45" width="50" height="60" fill="#f59e0b" opacity=".3" stroke="#f59e0b" stroke-width="2" stroke-dasharray="4,2"/><text x="200" y="150" text-anchor="middle" font-size="10" fill="#f59e0b">âš ï¸ é‚Šç•Œå•é¡Œ</text><text x="200" y="165" text-anchor="middle" font-size="9" fill="#94a3b8">æ­¤è™•å¯èƒ½æœ‰ 2 å€çªç™¼</text>
            </svg></div>
            <div class="info-box warning"><h4>âš ï¸ é‚Šç•Œå•é¡Œ</h4><p>å®¢æˆ¶ç«¯å¯èƒ½åœ¨ 12:00:59 ç™¼é€ 100 æ¬¡è«‹æ±‚ï¼Œ12:01:01 å†ç™¼é€ 100 æ¬¡â€”â€”2 ç§’å…§ 200 æ¬¡è«‹æ±‚ï¼Œå»éƒ½ç¬¦åˆæ¯åˆ†é˜é™åˆ¶ã€‚</p></div>
            <div class="code-block"><div class="code-header"><span class="code-lang">Python</span><span class="code-title">fixed_window.py</span></div><pre><code><span class="keyword">def</span> <span class="function">fixed_window_check</span>(user_id, limit, window_size):
    <span class="comment"># å–å¾—ç•¶å‰è¦–çª—çš„ Key</span>
    window = int(time.time() / window_size)
    key = f<span class="string">"{user_id}:{window}"</span>

    <span class="comment"># éå¢è¨ˆæ•¸å™¨</span>
    count = redis.incr(key)

    <span class="comment"># ç¬¬ä¸€æ¬¡è«‹æ±‚æ™‚è¨­å®šéæœŸæ™‚é–“</span>
    <span class="keyword">if</span> count == <span class="number">1</span>:
        redis.expire(key, window_size)

    <span class="keyword">return</span> count &lt;= limit</code></pre></div>
        </div>

        <!-- æ»‘å‹•è¦–çª—æ—¥èªŒ -->
        <div class="algorithm-deep">
            <h3>æ»‘å‹•è¦–çª—æ—¥èªŒ (Sliding Window Log) <span class="algo-badge">æœ€ç²¾ç¢º</span></h3>
            <p>å°‡æ¯å€‹è«‹æ±‚çš„æ™‚é–“æˆ³è¨˜å„²å­˜åœ¨æœ‰åºé›†åˆä¸­ã€‚è¨ˆç®—æ»‘å‹•è¦–çª—å…§çš„æ‰€æœ‰è«‹æ±‚ã€‚éå¸¸ç²¾ç¢ºä½†æ¶ˆè€—è¨˜æ†¶é«”ã€‚</p>
            <div class="code-block"><div class="code-header"><span class="code-lang">Python</span><span class="code-title">sliding_window_log.py</span></div><pre><code><span class="keyword">def</span> <span class="function">sliding_window_log</span>(user_id, limit, window_size):
    now = time.time()
    window_start = now - window_size
    key = f<span class="string">"rate_limit:{user_id}"</span>

    <span class="comment"># ç§»é™¤è¦–çª—å¤–çš„èˆŠè¨˜éŒ„</span>
    redis.zremrangebyscore(key, <span class="number">0</span>, window_start)

    <span class="comment"># è¨ˆç®—ç•¶å‰è¦–çª—å…§çš„è«‹æ±‚æ•¸</span>
    count = redis.zcard(key)

    <span class="keyword">if</span> count &lt; limit:
        <span class="comment"># æ·»åŠ ç•¶å‰è«‹æ±‚çš„æ™‚é–“æˆ³è¨˜</span>
        redis.zadd(key, {str(now): now})
        redis.expire(key, window_size)
        <span class="keyword">return</span> <span class="keyword">True</span>

    <span class="keyword">return</span> <span class="keyword">False</span></code></pre></div>
            <p><strong>è¨˜æ†¶é«”ï¼š</strong>O(n)ï¼Œn = è¦–çª—å…§çš„è«‹æ±‚æ•¸ã€‚100 è¬ç”¨æˆ¶ Ã— æ¯åˆ†é˜ 100 æ¬¡ = æœ€å·®æƒ…æ³ 1 å„„ç­†è¨˜éŒ„ï¼</p>
        </div>

        <!-- æ»‘å‹•è¦–çª—è¨ˆæ•¸ -->
        <div class="algorithm-deep">
            <h3>æ»‘å‹•è¦–çª—è¨ˆæ•¸ (Sliding Window Counter) <span class="algo-badge">æœ€ä½³å¹³è¡¡</span></h3>
            <p>çµåˆå›ºå®šè¦–çª—çš„æ•ˆç‡èˆ‡æ»‘å‹•è¦–çª—çš„ç²¾ç¢ºåº¦ï¼Œä½¿ç”¨åŠ æ¬Šå¹³å‡ã€‚</p>
            <div class="algorithm-visual"><svg viewBox="0 0 600 150" xmlns="http://www.w3.org/2000/svg">
                <rect x="50" y="40" width="200" height="60" fill="#94a3b8" opacity=".2" stroke="#94a3b8"/><text x="150" y="75" text-anchor="middle" font-size="12" fill="#64748b">å‰ä¸€è¦–çª—ï¼š84 æ¬¡</text><text x="150" y="115" text-anchor="middle" font-size="10" fill="#94a3b8">æ¬Šé‡ï¼š25%</text>
                <rect x="250" y="40" width="200" height="60" fill="#3b82f6" opacity=".2" stroke="#3b82f6"/><text x="350" y="75" text-anchor="middle" font-size="12" fill="#3b82f6">ç•¶å‰è¦–çª—ï¼š36 æ¬¡</text><text x="350" y="115" text-anchor="middle" font-size="10" fill="#3b82f6">æ¬Šé‡ï¼š75%</text>
                <rect x="100" y="35" width="200" height="70" fill="none" stroke="#f59e0b" stroke-width="2" stroke-dasharray="4,2"/><text x="200" y="25" text-anchor="middle" font-size="11" fill="#f59e0b">æ»‘å‹•è¦–çª—</text>
                <text x="500" y="65" font-size="11" fill="#64748b">ä¼°ç®—å€¼ï¼š</text><text x="500" y="82" font-size="13" fill="#f59e0b" font-weight="600">84Ã—0.25 + 36Ã—0.75</text><text x="500" y="99" font-size="13" fill="#f59e0b" font-weight="600">= 48 æ¬¡è«‹æ±‚</text>
            </svg></div>
            <div class="code-block"><div class="code-header"><span class="code-lang">Python</span><span class="code-title">sliding_window_counter.py</span></div><pre><code><span class="keyword">def</span> <span class="function">sliding_window_counter</span>(user_id, limit, window_size):
    now = time.time()
    current_window = int(now / window_size)
    prev_window = current_window - <span class="number">1</span>

    <span class="comment"># ç•¶å‰è¦–çª—å·²ç¶“éçš„æ™‚é–“æ¯”ä¾‹ (0 åˆ° 1)</span>
    elapsed = (now % window_size) / window_size

    <span class="comment"># å–å¾—å…©å€‹è¦–çª—çš„è¨ˆæ•¸</span>
    prev_count = int(redis.get(f<span class="string">"{user_id}:{prev_window}"</span>) <span class="keyword">or</span> <span class="number">0</span>)
    curr_count = int(redis.get(f<span class="string">"{user_id}:{current_window}"</span>) <span class="keyword">or</span> <span class="number">0</span>)

    <span class="comment"># åŠ æ¬Šä¼°ç®—</span>
    estimated = prev_count * (<span class="number">1</span> - elapsed) + curr_count

    <span class="keyword">if</span> estimated &lt; limit:
        redis.incr(f<span class="string">"{user_id}:{current_window}"</span>)
        <span class="keyword">return</span> <span class="keyword">True</span>

    <span class="keyword">return</span> <span class="keyword">False</span></code></pre></div>
        </div>

        <!-- æ¯”è¼ƒè¡¨ -->
        <h3>æ¼”ç®—æ³•æ¯”è¼ƒ</h3>
        <table class="comparison-table"><thead><tr><th>æ¼”ç®—æ³•</th><th>è¨˜æ†¶é«”</th><th>ç²¾ç¢ºåº¦</th><th>çªç™¼</th><th>è¤‡é›œåº¦</th></tr></thead><tbody>
            <tr><td><strong>ä»¤ç‰Œæ¡¶</strong></td><td class="badge-good">O(1)</td><td class="badge-good">ä½³</td><td class="badge-good">å…è¨±</td><td class="badge-good">ç°¡å–®</td></tr>
            <tr><td><strong>æ¼æ¡¶</strong></td><td class="badge-good">O(1)</td><td class="badge-good">ä½³</td><td class="badge-poor">å¹³æ»‘</td><td class="badge-good">ç°¡å–®</td></tr>
            <tr><td><strong>å›ºå®šè¦–çª—</strong></td><td class="badge-good">O(1)</td><td class="badge-poor">å·®</td><td class="badge-poor">é‚Šç•Œ2å€</td><td class="badge-good">æœ€ç°¡å–®</td></tr>
            <tr><td><strong>æ»‘å‹•æ—¥èªŒ</strong></td><td class="badge-poor">O(n)</td><td class="badge-good">ç²¾ç¢º</td><td class="badge-medium">ç„¡é¡å¤–</td><td class="badge-medium">ä¸­ç­‰</td></tr>
            <tr><td><strong>æ»‘å‹•è¨ˆæ•¸</strong></td><td class="badge-good">O(1)</td><td class="badge-medium">ç´„ä½³</td><td class="badge-medium">å¹³æ»‘</td><td class="badge-medium">ä¸­ç­‰</td></tr>
        </tbody></table>
    </div></section>

    <!-- 3. å¯¦ä½œç´°ç¯€ -->
    <section id="dd-impl"><div class="container-narrow">
        <h2 class="bordered">3. å¯¦ä½œç´°ç¯€</h2>
        <h3>é™æµå™¨æ”¾ç½®ä½ç½®</h3>
        <div class="diagram-section"><div class="step-by-step">
            <div class="step-item"><div class="step-item-content"><h4>API é–˜é“å±¤</h4><p>æœ€å¸¸è¦‹çš„æ–¹å¼ã€‚åœ¨è«‹æ±‚åˆ°é”æœå‹™å‰æ–¼é–˜é“è™•ç†ã€‚ä¾‹å¦‚ï¼šKongã€AWS API Gatewayã€Nginxã€‚</p></div></div>
            <div class="step-item"><div class="step-item-content"><h4>æ‡‰ç”¨ä¸­ä»‹è»Ÿé«”</h4><p>åµŒå…¥æ‡‰ç”¨ç¨‹å¼ç¢¼ä¸­ã€‚å¯ç´°ç²’åº¦æ§åˆ¶ï¼Œä½†éœ€åœ¨æ¯å€‹æœå‹™å¯¦ä½œã€‚</p></div></div>
            <div class="step-item"><div class="step-item-content"><h4>Sidecar Proxy</h4><p>æœå‹™ç¶²æ ¼æ¨¡å¼ï¼ˆEnvoyã€Istioï¼‰ã€‚èˆ‡æ‡‰ç”¨ç¨‹å¼ç¢¼è§£è€¦ã€‚</p></div></div>
        </div></div>
        <h3>å®¢æˆ¶ç«¯è­˜åˆ¥æ–¹å¼</h3>
        <table class="comparison-table"><thead><tr><th>è­˜åˆ¥ç¬¦</th><th>ä½¿ç”¨å ´æ™¯</th><th>å„ªé»</th><th>ç¼ºé»</th></tr></thead><tbody>
            <tr><td><code>IP ä½å€</code></td><td>åŒ¿åç”¨æˆ¶</td><td>ç°¡å–®ã€æ°¸é å¯ç”¨</td><td>å…±äº« IPã€VPN</td></tr>
            <tr><td><code>ç”¨æˆ¶ ID</code></td><td>å·²èªè­‰ç”¨æˆ¶</td><td>ç²¾ç¢ºåˆ°æ¯å€‹ç”¨æˆ¶</td><td>éœ€è¦èªè­‰</td></tr>
            <tr><td><code>API Key</code></td><td>B2B / é–‹ç™¼è€…</td><td>ç¶å®šå¸³æˆ¶/æ–¹æ¡ˆ</td><td>Key ç®¡ç†</td></tr>
            <tr><td><code>çµ„åˆ</code></td><td>å¤šå±¤é˜²è­·</td><td>æ·±åº¦é˜²ç¦¦</td><td>è¤‡é›œåº¦</td></tr>
        </tbody></table>
    </div></section>

    <!-- 4. åˆ†æ•£å¼é™æµ -->
    <section id="dd-dist" class="section-alt"><div class="container-narrow">
        <h2 class="bordered">4. åˆ†æ•£å¼é™æµ</h2>
        <div class="info-box concept"><h4>ğŸ”‘ æ ¸å¿ƒæŒ‘æˆ°</h4><p>è‹¥æœ‰ 5 å€‹é™æµå™¨å¯¦ä¾‹å„è‡ªç¶­è­·è¨ˆæ•¸å™¨ï¼Œå®¢æˆ¶ç«¯å¯èƒ½ç™¼é€ 5 å€æ–¼é æœŸçš„è«‹æ±‚é‡ã€‚</p></div>
        <h4>1. é›†ä¸­å¼è³‡æ–™å„²å­˜ï¼ˆRedisï¼‰</h4>
        <p>æ‰€æœ‰å¯¦ä¾‹å…±äº«å–®ä¸€ Redis å¢é›†ã€‚æœ€å¸¸è¦‹çš„æ–¹æ¡ˆã€‚</p>
        <div class="code-block"><div class="code-header"><span class="code-lang">Python</span><span class="code-title">distributed_rate_limiter.py</span></div><pre><code><span class="keyword">class</span> <span class="function">DistributedRateLimiter</span>:
    <span class="keyword">def</span> <span class="function">__init__</span>(self, redis_client, limit, window):
        self.redis = redis_client
        self.limit = limit
        self.window = window

    <span class="keyword">def</span> <span class="function">is_allowed</span>(self, client_id):
        key = f<span class="string">"rate_limit:{client_id}"</span>
        now = time.time()

        <span class="comment"># ä½¿ç”¨ Redis pipeline ç¢ºä¿åŸå­æ“ä½œ</span>
        pipe = self.redis.pipeline()
        pipe.zremrangebyscore(key, <span class="number">0</span>, now - self.window)
        pipe.zadd(key, {str(now): now})
        pipe.zcard(key)
        pipe.expire(key, self.window)
        results = pipe.execute()

        count = results[<span class="number">2</span>]
        <span class="keyword">return</span> count &lt;= self.limit</code></pre></div>
        <h4>2. é»æ€§æœƒè©± (Sticky Sessions)</h4><p>é€éä¸€è‡´æ€§é›œæ¹Šå°‡ç›¸åŒå®¢æˆ¶ç«¯è·¯ç”±åˆ°ç›¸åŒå¯¦ä¾‹ã€‚è¼ƒç°¡å–®ä½†å®¹éŒ¯æ€§è¼ƒå·®ã€‚</p>
        <h4>3. å¯¦ä¾‹é–“åŒæ­¥</h4><p>å®šæœŸåŒæ­¥è¨ˆæ•¸å™¨ã€‚çŠ§ç‰²ç²¾ç¢ºåº¦æ›å–è¼ƒä½å»¶é²ã€‚</p>
        <div class="info-box tip"><h4>ğŸ’¡ æœ€ä½³å¯¦è¸</h4><p>ä½¿ç”¨å¸¶æœ‰è¤‡è£½çš„ Redis Cluster ç¢ºä¿é«˜å¯ç”¨ã€‚1-2ms çš„é¡å¤–å»¶é²å°å¤§å¤šæ•¸å ´æ™¯æ˜¯å¯æ¥å—çš„ã€‚</p></div>
    </div></section>

    <!-- 5. Redis å¯¦ä½œ -->
    <section id="dd-redis"><div class="container-narrow">
        <h2 class="bordered">5. Redis å¯¦ä½œ</h2>
        <h3>Lua è…³æœ¬ç¢ºä¿åŸå­æ“ä½œ</h3>
        <div class="code-block"><div class="code-header"><span class="code-lang">Lua</span><span class="code-title">rate_limit.lua</span></div><pre><code><span class="comment">-- KEYS[1] = é™æµ key</span>
<span class="comment">-- ARGV[1] = é™åˆ¶, ARGV[2] = è¦–çª—å¤§å°</span>

<span class="keyword">local</span> key = KEYS[<span class="number">1</span>]
<span class="keyword">local</span> limit = tonumber(ARGV[<span class="number">1</span>])
<span class="keyword">local</span> window = tonumber(ARGV[<span class="number">2</span>])
<span class="keyword">local</span> now = redis.call(<span class="string">'TIME'</span>)
<span class="keyword">local</span> timestamp = now[<span class="number">1</span>] + now[<span class="number">2</span>] / <span class="number">1000000</span>
<span class="keyword">local</span> window_start = timestamp - window

<span class="comment">-- ç§»é™¤èˆŠè¨˜éŒ„</span>
redis.call(<span class="string">'ZREMRANGEBYSCORE'</span>, key, <span class="number">0</span>, window_start)

<span class="comment">-- è¨ˆç®—ç•¶å‰è¨˜éŒ„æ•¸</span>
<span class="keyword">local</span> count = redis.call(<span class="string">'ZCARD'</span>, key)

<span class="keyword">if</span> count &lt; limit <span class="keyword">then</span>
    redis.call(<span class="string">'ZADD'</span>, key, timestamp, timestamp)
    redis.call(<span class="string">'EXPIRE'</span>, key, window)
    <span class="keyword">return</span> {<span class="number">1</span>, limit - count - <span class="number">1</span>, window}
<span class="keyword">else</span>
    <span class="keyword">local</span> oldest = redis.call(<span class="string">'ZRANGE'</span>, key, <span class="number">0</span>, <span class="number">0</span>, <span class="string">'WITHSCORES'</span>)
    <span class="keyword">local</span> retry_after = oldest[<span class="number">2</span>] + window - timestamp
    <span class="keyword">return</span> {<span class="number">0</span>, <span class="number">0</span>, retry_after}
<span class="keyword">end</span></code></pre></div>
        <h3>Redis è³‡æ–™çµæ§‹é¸æ“‡</h3>
        <table class="comparison-table"><thead><tr><th>è³‡æ–™çµæ§‹</th><th>æ¼”ç®—æ³•</th><th>æŒ‡ä»¤</th></tr></thead><tbody>
            <tr><td><code>String</code></td><td>å›ºå®šè¦–çª—</td><td>INCR, EXPIRE, GET</td></tr>
            <tr><td><code>Hash</code></td><td>æ»‘å‹•è¦–çª—è¨ˆæ•¸</td><td>HINCRBY, HGET</td></tr>
            <tr><td><code>Sorted Set</code></td><td>æ»‘å‹•è¦–çª—æ—¥èªŒ</td><td>ZADD, ZREMRANGEBYSCORE, ZCARD</td></tr>
        </tbody></table>
    </div></section>

    <!-- 6. HTTP æ¨™é ­ -->
    <section id="dd-headers" class="section-alt"><div class="container-narrow">
        <h2 class="bordered">6. HTTP æ¨™é ­èˆ‡å›æ‡‰</h2>
        <h3>æ¨™æº–é™æµæ¨™é ­</h3>
        <div class="code-block"><div class="code-header"><span class="code-lang">HTTP</span><span class="code-title">å›æ‡‰æ¨™é ­</span></div><pre><code>HTTP/1.1 200 OK
X-RateLimit-Limit: 100          <span class="comment"># å…è¨±çš„æœ€å¤§è«‹æ±‚æ•¸</span>
X-RateLimit-Remaining: 45       <span class="comment"># å‰©é¤˜è«‹æ±‚æ•¸</span>
X-RateLimit-Reset: 1704067260   <span class="comment"># é™åˆ¶é‡ç½®çš„ Unix æ™‚é–“æˆ³è¨˜</span>
X-RateLimit-Policy: 100;w=60    <span class="comment"># ç­–ç•¥ï¼š60 ç§’å…§ 100 æ¬¡</span></code></pre></div>
        <h3>429 å›æ‡‰</h3>
        <div class="code-block"><div class="code-header"><span class="code-lang">HTTP</span><span class="code-title">è¢«é™æµçš„å›æ‡‰</span></div><pre><code>HTTP/1.1 429 Too Many Requests
Content-Type: application/json
Retry-After: 30
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 0
X-RateLimit-Reset: 1704067260

{
    <span class="string">"error"</span>: {
        <span class="string">"code"</span>: <span class="string">"RATE_LIMIT_EXCEEDED"</span>,
        <span class="string">"message"</span>: <span class="string">"è«‹æ±‚éå¤šï¼Œè«‹ 30 ç§’å¾Œé‡è©¦ã€‚"</span>,
        <span class="string">"retry_after"</span>: <span class="number">30</span>
    }
}</code></pre></div>
        <div class="info-box important"><h4>ğŸ¯ æœ€ä½³å¯¦è¸</h4><p>æ°¸é åŠ å…¥ <code>Retry-After</code> æ¨™é ­ã€‚é˜²æ­¢ã€Œé©šç¾¤æ•ˆæ‡‰ã€é€ æˆæ‰€æœ‰å®¢æˆ¶ç«¯åŒæ™‚é‡è©¦ã€‚</p></div>
    </div></section>

    <!-- 7. é™æµç­–ç•¥ -->
    <section id="dd-strat"><div class="container-narrow">
        <h2 class="bordered">7. é™æµç­–ç•¥</h2>
        <h3>ä¾ç¯„åœåˆ†é¡</h3>
        <ul><li><strong>å…¨åŸŸé™æµ</strong> â€” æ•´å€‹ API çš„å–®ä¸€é™åˆ¶ï¼ˆæ¯åˆ†é˜å…± 10,000 æ¬¡ï¼‰</li><li><strong>ç”¨æˆ¶é™æµ</strong> â€” æ¯å€‹ç”¨æˆ¶æœ‰è‡ªå·±çš„é…é¡</li><li><strong>ç«¯é»é™æµ</strong> â€” ä¸åŒç«¯é»æœ‰ä¸åŒé™åˆ¶</li><li><strong>æ–¹æ¡ˆé™æµ</strong> â€” ä¾è¨‚é–±å±¤ç´šæœ‰ä¸åŒé™åˆ¶</li></ul>
        <h3>åˆ†å±¤é™æµé…ç½®</h3>
        <div class="code-block"><div class="code-header"><span class="code-lang">YAML</span><span class="code-title">rate_limits.yaml</span></div><pre><code><span class="keyword">plans:</span>
  <span class="keyword">free:</span>
    <span class="keyword">requests_per_minute:</span> <span class="number">60</span>
    <span class="keyword">requests_per_day:</span> <span class="number">1000</span>
    <span class="keyword">burst:</span> <span class="number">10</span>

  <span class="keyword">pro:</span>
    <span class="keyword">requests_per_minute:</span> <span class="number">600</span>
    <span class="keyword">requests_per_day:</span> <span class="number">50000</span>
    <span class="keyword">burst:</span> <span class="number">100</span>

  <span class="keyword">enterprise:</span>
    <span class="keyword">requests_per_minute:</span> <span class="number">6000</span>
    <span class="keyword">requests_per_day:</span> unlimited
    <span class="keyword">burst:</span> <span class="number">1000</span>

<span class="keyword">endpoints:</span>
  <span class="keyword">/api/v1/search:</span>
    <span class="keyword">multiplier:</span> <span class="number">0.5</span>  <span class="comment"># æ¶ˆè€—å¤§ï¼Œé™åˆ¶æ¸›åŠ</span>

  <span class="keyword">/api/v1/upload:</span>
    <span class="keyword">multiplier:</span> <span class="number">0.1</span>  <span class="comment"># éå¸¸æ¶ˆè€—è³‡æº</span></code></pre></div>
        <h3>å„ªé›…é™ç´š</h3>
        <div class="info-box warning"><h4>âš ï¸ Redis æ›æ‰æ€éº¼è¾¦ï¼Ÿ</h4><p><strong>é–‹æ”¾æ”¾è¡Œ (Fail Open)</strong>ï¼ˆå…è¨±å…¨éƒ¨ï¼‰é€šå¸¸è¼ƒä½³ï¼Œé¿å…å®Œå…¨ä¸­æ–·ã€‚<strong>é—œé–‰æ‹’çµ• (Fail Closed)</strong>ï¼ˆæ‹’çµ•å…¨éƒ¨ï¼‰è¼ƒå®‰å…¨ä½†å½±éŸ¿å¯ç”¨æ€§ã€‚</p></div>
    </div></section>

    <!-- 8. é¢è©¦é¡Œåº« -->
    <section id="dd-qa" class="section-alt"><div class="container-narrow">
        <h2 class="bordered">8. é¢è©¦é¡Œåº«</h2>
        <div class="interview-qa">
            <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)">Qï¼šè¨­è¨ˆä¸€å€‹æ¯ç§’è™•ç† 100 è¬è«‹æ±‚çš„é™æµå™¨</div><div class="qa-answer"><p><strong>é—œéµè€ƒé‡ï¼š</strong></p><ul><li><strong>åˆ†æ•£å¼æ¶æ§‹</strong> â€” Redis Cluster æ­é…åˆ†ç‰‡ï¼ˆæ¯ç¯€é»ç´„ 10 è¬ ops/secï¼‰</li><li><strong>æ¼”ç®—æ³•é¸æ“‡</strong> â€” ä»¤ç‰Œæ¡¶æˆ–æ»‘å‹•è¦–çª—è¨ˆæ•¸ã€‚é¿å…æ»‘å‹•æ—¥èªŒï¼ˆO(n) è¨˜æ†¶é«”ï¼‰ã€‚</li><li><strong>å»¶é²é ç®—</strong> â€” &lt;5msã€‚å°‡ Redis éƒ¨ç½²åœ¨åŒå€åŸŸã€‚</li><li><strong>æ•…éšœè™•ç†</strong> â€” æ­é…ç†”æ–·å™¨çš„é–‹æ”¾æ”¾è¡Œã€‚</li><li><strong>ä¸€è‡´æ€§é›œæ¹Š</strong> â€” å°‡ç›¸åŒç”¨æˆ¶è·¯ç”±åˆ°ç›¸åŒåˆ†ç‰‡ã€‚</li></ul></div></div>
            <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)">Qï¼šå¦‚ä½•è™•ç†å¤šå€åŸŸçš„é™æµï¼Ÿ</div><div class="qa-answer"><p><strong>æ–¹æ¡ˆï¼š</strong></p><ul><li><strong>æœ¬åœ° + å…¨åŸŸé™åˆ¶</strong> â€” æ¯å€‹å€åŸŸæœ‰è‡ªå·±çš„é™åˆ¶ï¼ŒåŠ ä¸Šè·¨å€åŸŸçš„å…¨åŸŸé™åˆ¶ã€‚</li><li><strong>å€åŸŸé–“åŒæ­¥</strong> â€” å®šæœŸåŒæ­¥è¨ˆæ•¸å™¨ï¼ˆæœ€çµ‚ä¸€è‡´æ€§ï¼‰ã€‚</li><li><strong>ä¸­å¤®å”èª¿è€…</strong> â€” å–®ä¸€å…¨åŸŸ Redis æ­é…ç•°åœ°è¤‡è£½ã€‚å»¶é²è¼ƒé«˜ã€‚</li><li><strong>ä»¤ç‰Œåˆ†é…</strong> â€” ä¾é æœŸæµé‡é å…ˆåˆ†é…ä»¤ç‰Œçµ¦å„å€åŸŸã€‚</li></ul><p><strong>å»ºè­°ï¼š</strong>æœ¬åœ° 90% + å…¨åŸŸ 10% å–å¾—å¹³è¡¡ã€‚</p></div></div>
            <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)">Qï¼šé™æµï¼ˆRate Limitingï¼‰èˆ‡ç¯€æµï¼ˆThrottlingï¼‰çš„å·®ç•°ï¼Ÿ</div><div class="qa-answer"><p><strong>é™æµï¼š</strong>ç¡¬æ€§æ‹’çµ•ï¼ˆç«‹å³å›å‚³ 429ï¼‰ã€‚</p><p><strong>ç¯€æµï¼š</strong>æ¸›é€Ÿè™•ç†â€”â€”æ’éšŠä¸¦ä»¥å—æ§é€Ÿç‡è™•ç†ã€‚</p><ul><li><strong>é™æµ</strong> â€” å°å¤– APIã€DoS é˜²è­·</li><li><strong>ç¯€æµ</strong> â€” å…§éƒ¨æœå‹™ã€æ‰¹æ¬¡è™•ç†ã€QoS</li></ul></div></div>
            <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)">Qï¼šå¦‚ä½•é˜²ç¦¦åˆ†æ•£å¼æ”»æ“Šï¼ˆå¤š IPï¼‰ï¼Ÿ</div><div class="qa-answer"><ul><li><strong>å¤šé‡è­˜åˆ¥ç¬¦</strong> â€” IP + User-Agent + API Key</li><li><strong>æŒ‡ç´‹è¾¨è­˜</strong> â€” ç€è¦½å™¨/è£ç½®æŒ‡ç´‹</li><li><strong>è¡Œç‚ºåˆ†æ</strong> â€” åµæ¸¬ç•°å¸¸æ¨¡å¼</li><li><strong>å…¨åŸŸé™æµ</strong> â€” é™åˆ¶æ¯å€‹ç«¯é»çš„ç¸½è«‹æ±‚</li><li><strong>CAPTCHA/PoW</strong> â€” å·¥ä½œé‡è­‰æ˜æŒ‘æˆ°</li><li><strong>IP ä¿¡è­½</strong> â€” å¨è„…æƒ…å ±ä¾†æº</li></ul></div></div>
            <div class="qa-item"><div class="qa-question" onclick="toggleQA(this)">Qï¼šç‚ºä»€éº¼ç”¨ 429 è€Œä¸æ˜¯ 503ï¼Ÿ</div><div class="qa-answer"><p><strong>429 Too Many Requestsï¼š</strong>é‡å°ç‰¹å®šå®¢æˆ¶ç«¯â€”â€”<em>é€™å€‹</em>å®¢æˆ¶ç«¯è¶…éé™åˆ¶ã€‚å…¶ä»–å®¢æˆ¶ç«¯å¯èƒ½æ­£å¸¸ã€‚</p><p><strong>503 Service Unavailableï¼š</strong>å…¨ä¼ºæœå™¨â€”â€”æ•´å€‹æœå‹™éè¼‰ã€‚</p><p><strong>æœ€ä½³å¯¦è¸ï¼š</strong>é™æµç”¨ 429ï¼ŒçœŸæ­£çš„æœå‹™ä¸­æ–·ç”¨ 503ã€‚</p></div></div>
        </div>
    </div></section>

</div><!-- end deep dive page -->


<!-- ===== FOOTER ===== -->
<footer>
    <div class="container">
        <p>API é™æµå™¨ â€” å®Œæ•´ç³»çµ±è¨­è¨ˆæŒ‡å— â€¢ å°ˆç‚ºå­¸ç¿’æ‰“é€ </p>
    </div>
</footer>

<script>
function switchPage(pageId, btn) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.querySelectorAll('.page-tab').forEach(t => t.classList.remove('active'));
    document.getElementById('page-' + pageId).classList.add('active');
    btn.classList.add('active');
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

function showFlow(flowId, btn) {
    document.querySelectorAll('.flow-content').forEach(c => c.classList.remove('active'));
    document.querySelectorAll('.flow-tab').forEach(t => t.classList.remove('active'));
    document.getElementById('flow-' + flowId).classList.add('active');
    btn.classList.add('active');
}

function toggleQA(el) {
    el.parentElement.classList.toggle('open');
}

function scrollDD(e, id) {
    e.preventDefault();
    document.getElementById(id).scrollIntoView({ behavior: 'smooth', block: 'start' });
}
</script>
</body>
</html>
